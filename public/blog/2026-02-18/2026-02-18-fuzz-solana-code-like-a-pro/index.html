<!DOCTYPE html>
<html lang="en"
  data-cb-collapse-enabled=""
  data-cb-collapse-default=""
  data-cb-collapse-lines=""
  data-cb-collapse-auto-height=""
  data-cb-collapse-collapsed-height="">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Fuzz solana programs like a Pro - Part 1 | Minimal Black Theme</title>

<meta name="description" content="A minimal personal site" />




  <link rel="icon" type="image/x-icon" href="/icons/favicon.svg" />




  <link rel="apple-touch-icon" href="/home/agathokako/saurabh/my-portfolio/content/blog/2026-02-18/2026-02-18-fuzz-solana-code-like-a-pro.md" />




  
    
  
    
  
    
  
    
      <link rel="manifest" href="http://localhost:1313/manifest.webmanifest" />
    
  


<link rel="stylesheet" href="/css/main.css"> 


  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
  >



  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/devicons/devicon@v2.17.0/devicon.min.css"
  >



<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css"
/>


<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/justified-gallery@3.8.2/dist/css/justifiedGallery.min.css"
/>

<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>
  mermaid.initialize({ theme: "dark" });
</script>

<script>
  (function () {
    try {
      var stored = localStorage.getItem("theme");
      var systemDark =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;
      var defaultTheme =
        'dark';

      var theme =
        stored ||
        (defaultTheme === "dark"
          ? "dark"
          : defaultTheme === "light"
          ? "light"
          : systemDark
          ? "dark"
          : "light");

      document.documentElement.setAttribute("data-theme", theme);
    } catch (e) {
      document.documentElement.setAttribute("data-theme", "light");
    }
  })();
</script>




  </head>
  <body class="min-h-screen bg-bg text-text antialiased">
    <div class="flex min-h-screen flex-col">
      <header class="pt-6">
  <div class="mx-auto max-w-7xl px-4 sm:px-6">
    
    <div class="nav-shell">
      <div class="nav-inner">
        
        <a href="/" class="flex items-center gap-2">
          
            <div class="flex h-8 w-8 items-center justify-center overflow-hidden rounded-full bg-surface">
              <img
                src="/images/logo.jpg"
                alt="Saurabh"
                class="h-full w-full object-cover"
              >
            </div>
          
          <span class="text-xs font-semibold tracking-wide">
            Saurabh
          </span>
        </a>

        <div class="flex items-center gap-2">
          
          <nav class="hidden items-center gap-5 md:flex">
              <a
                href="/"
                class="nav-link link-underline flex items-center gap-1 "
              >
                
                  <i class="fa-solid fa-house text-[0.75rem]"></i>
                
                <span>Home</span>
              </a>
              <a
                href="/about/"
                class="nav-link link-underline flex items-center gap-1 "
              >
                
                  <i class="fa-regular fa-user text-[0.75rem]"></i>
                
                <span>About</span>
              </a>
              <a
                href="/blog/"
                class="nav-link link-underline flex items-center gap-1 "
              >
                
                  <i class="fa-regular fa-note-sticky text-[0.75rem]"></i>
                
                <span>Blog</span>
              </a>
          </nav>

          
          <button
  type="button"
  class="theme-toggle"
  aria-label="Toggle dark mode"
  data-theme-toggle
>
  <span data-theme-icon-light style="display: none">
    
    <svg
      xmlns="http://www.w3.org/2000/svg"
      class="h-4 w-4"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="1.5"
      stroke-linecap="round"
      stroke-linejoin="round"
    >
      <circle cx="12" cy="12" r="4" />
      <path
        d="M12 3v2m0 14v2m9-9h-2M5 12H3m15.364-6.364-1.414 1.414M8.05 15.95l-1.414 1.414m0-11.314L8.05 8.05m9.9 9.9-1.414-1.414"
      />
    </svg>
  </span>

  <span data-theme-icon-dark>
    
    <svg
      xmlns="http://www.w3.org/2000/svg"
      class="h-4 w-4"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="1.5"
      stroke-linecap="round"
      stroke-linejoin="round"
    >
      <path d="M21 12.79A9 9 0 0 1 12.21 3 7 7 0 1 0 21 12.79z" />
    </svg>
  </span>
</button>


          
          <button
            type="button"
            class="ml-1 inline-flex items-center justify-center rounded-full border border-border bg-bg p-2 text-muted shadow-sm hover:text-accent md:hidden"
            aria-label="Toggle navigation"
            data-mobile-nav-toggle
          >
            <span class="sr-only">Open navigation</span>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none"
                 stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <line x1="4" y1="6" x2="20" y2="6" />
              <line x1="4" y1="12" x2="20" y2="12" />
              <line x1="4" y1="18" x2="20" y2="18" />
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  
  <div class="mx-auto mt-2 max-w-7xl px-4 sm:px-6 md:hidden">
    <nav
      class="hidden rounded-2xl border border-border bg-surface px-4 py-3 text-sm text-muted shadow-md"
      data-mobile-nav
    >
      
        <a href="/" class="flex items-center gap-2 py-1.5">
          
            <i class="fa-solid fa-house text-[0.8rem]"></i>
          
          <span>Home</span>
        </a>
      
        <a href="/about/" class="flex items-center gap-2 py-1.5">
          
            <i class="fa-regular fa-user text-[0.8rem]"></i>
          
          <span>About</span>
        </a>
      
        <a href="/blog/" class="flex items-center gap-2 py-1.5">
          
            <i class="fa-regular fa-note-sticky text-[0.8rem]"></i>
          
          <span>Blog</span>
        </a>
      
    </nav>
  </div>
</header>


      <main class="flex-1">
        
  <section class="layout-page section-stack">
    <div class="article-layout">
      <article class="article-main space-y-4">
        <header class="space-y-2">
          <h1 class="heading-page text-2xl sm:text-3xl">Fuzz solana programs like a Pro - Part 1</h1>

          <div class="text-[0.75rem] text-muted">
            
              <span>18 Feb 2026</span>
            
            
              <span> • 9 min read</span>
            
          </div>

          
        </header>

        <div class="card card-pad">
          <div class="markdown-body">
            <p>Smart contract exploits rarely come from obvious code paths. They emerge from unexpected edge case sequences of state transitions that traditional tests never explore.
Most of the smart contracts today rely heavily on unit tests. Unit tests validate correctness along expected flows. Attackers don’t follow expected flows. This is where fuzzing becomes indispensable.</p>
<p>In this article, we’ll walk through how to write real, invariant-driven fuzz tests using Trident, a purpose-built fuzzing framework for Solana programs.</p>
<h3 id="why-fuzzing-matters-in-solana-security-">
  <a href="#why-fuzzing-matters-in-solana-security-" class="md-heading-anchor">
    Why Fuzzing Matters in Solana Security ?
  </a>
</h3>
<p>Unit tests validate known scenarios but miss edge cases, while stateless fuzzing adds randomness without modeling real protocol logic.
Stateful fuzzing simulates sequences of actions and state transitions, uncovering realistic economic and logic bugs.
DeFi protocols are state machines. Bugs do not emerge from single calls, but from sequences of complex operations. That’s why stateful fuzzing is essential.</p>
<h3 id="what-is-trident">
  <a href="#what-is-trident" class="md-heading-anchor">
    What is Trident?
  </a>
</h3>
<p>Trident is a Rust-native fuzzing framework built specifically for Solana programs and Anchor-based protocols. It was developed by <a
  href="https://ackee.xyz/"
  target="_blank" rel="noopener"
  class="md-link"
>
  Ackee Blockchain Security
</a>
 to bring invariant-driven fuzzing to the Solana ecosystem.</p>
<h4 id="unlike-generic-fuzzers-trident-understands">
  <a href="#unlike-generic-fuzzers-trident-understands" class="md-heading-anchor">
    Unlike generic fuzzers, Trident understands:
  </a>
</h4>
<ul>
<li>Solana accounts</li>
<li>Program instructions</li>
<li>Multi-user state transitions</li>
<li>Deterministic replay</li>
</ul>
<p>It allows you to write structured fuzz tests that simulate adversarial user behavior while validating protocol invariants.</p>
<h4 id="mental-model-of-a-trident-fuzz-test">
  <a href="#mental-model-of-a-trident-fuzz-test" class="md-heading-anchor">
    Mental Model of a Trident Fuzz Test
  </a>
</h4>
<p>Before writing code, build the right mental model.
A Trident fuzz test has four core components:</p>
<ul>
<li>Fuzz target — orchestrates execution</li>
<li>Handlers — simulate user actions</li>
<li>Invariants — safety properties that must hold</li>
<li>Multi-Instruction transaction — Execute multiple instructions in a single transaction</li>
</ul>
<p>Conceptually:</p>
<blockquote class="md-blockquote">
    <p>Random Input → Action → Program Call → State Change → Invariant Check</p>

  </blockquote><p>The fuzzer generates inputs, handlers translate them into meaningful actions, and invariants validate correctness. This separation of responsibilities is key to writing effective fuzz tests.</p>
<h4 id="setup-and-installation">
  <a href="#setup-and-installation" class="md-heading-anchor">
    Setup and Installation
  </a>
</h4>
<p>You’ll need a typical Solana development environment:
<a
  href="https://rust-lang.org/tools/install/"
  target="_blank" rel="noopener"
  class="md-link"
>
  Rust toolchain
</a>
,
<a
  href="https://solana.com/docs/intro/installation"
  target="_blank" rel="noopener"
  class="md-link"
>
  Solana CLI
</a>
,
<a
  href="https://solana.com/docs/intro/installation/anchor-cli-basics"
  target="_blank" rel="noopener"
  class="md-link"
>
  Anchor framework
</a>
</p>
<p>Install Trident:</p>
<blockquote class="md-blockquote">
    <p>cargo install trident-cli</p>

  </blockquote><p>Verify installation:</p>
<blockquote class="md-blockquote">
    <p>trident &ndash;version</p>

  </blockquote><h4 id="introducing-the-vault-example">
  <a href="#introducing-the-vault-example" class="md-heading-anchor">
    Introducing the Vault Example
  </a>
</h4>
<p>To make this practical, let’s take a example of simple vault program.</p>
<div class="mb-codeblock" id="cb-5feceb66" data-lang="rust">
  
  <div class="mb-codeblock-header">
    <div class="mb-codeblock-left">
      <span class="mb-codeblock-badge">
        RUST
      </span></div>

    <div class="mb-codeblock-actions"><button class="mb-action-btn mb-collapse-btn" data-collapsed="false" aria-label="Collapse code">
          <i class="fas fa-compress-alt"></i>
          <span>Collapse</span>
        </button><button class="mb-action-btn mb-copy-btn" aria-label="Copy code">
        <i class="fas fa-copy"></i>
        <span>Copy</span>
      </button>
    </div>
  </div>

  
  <div 
    class="mb-codeblock-content" 
    data-state="expanded"
  >
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">use</span><span class="w"> </span><span class="n">anchor_lang</span>::<span class="n">prelude</span>::<span class="o">*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="k">use</span><span class="w"> </span><span class="n">anchor_lang</span>::<span class="n">system_program</span>::<span class="p">{</span><span class="n">transfer</span><span class="p">,</span><span class="w"> </span><span class="n">Transfer</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="fm">declare_id!</span><span class="p">(</span><span class="s">&#34;Your program ID&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="cp">#[program]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="k">pub</span><span class="w"> </span><span class="k">mod</span> <span class="nn">vault</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="k">super</span>::<span class="o">*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">deposit</span><span class="p">(</span><span class="n">ctx</span>: <span class="nc">Context</span><span class="o">&lt;</span><span class="n">VaultAction</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span>: <span class="kt">u64</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// deposit logic
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// Check if vault is empty
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="fm">require_eq!</span><span class="p">(</span><span class="n">ctx</span><span class="p">.</span><span class="n">accounts</span><span class="p">.</span><span class="n">vault</span><span class="p">.</span><span class="n">lamports</span><span class="p">(),</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">VaultError</span>::<span class="n">VaultAlreadyExists</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// Ensure amount exceeds rent-exempt minimum
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="fm">require_gt!</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span><span class="w"> </span><span class="n">Rent</span>::<span class="n">get</span><span class="p">()</span><span class="o">?</span><span class="p">.</span><span class="n">minimum_balance</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">VaultError</span>::<span class="n">InvalidAmount</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">transfer</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">CpiContext</span>::<span class="n">new</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">ctx</span><span class="p">.</span><span class="n">accounts</span><span class="p">.</span><span class="n">system_program</span><span class="p">.</span><span class="n">to_account_info</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">Transfer</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">from</span>: <span class="nc">ctx</span><span class="p">.</span><span class="n">accounts</span><span class="p">.</span><span class="n">signer</span><span class="p">.</span><span class="n">to_account_info</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">to</span>: <span class="nc">ctx</span><span class="p">.</span><span class="n">accounts</span><span class="p">.</span><span class="n">vault</span><span class="p">.</span><span class="n">to_account_info</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">amount</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">)</span><span class="o">?</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nb">Ok</span><span class="p">(())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">withdraw</span><span class="p">(</span><span class="n">ctx</span>: <span class="nc">Context</span><span class="o">&lt;</span><span class="n">VaultAction</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// withdraw logic
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// Check if vault has any lamports
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="fm">require_neq!</span><span class="p">(</span><span class="n">ctx</span><span class="p">.</span><span class="n">accounts</span><span class="p">.</span><span class="n">vault</span><span class="p">.</span><span class="n">lamports</span><span class="p">(),</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">VaultError</span>::<span class="n">InvalidAmount</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// Create PDA signer seeds
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">signer_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="n">accounts</span><span class="p">.</span><span class="n">signer</span><span class="p">.</span><span class="n">key</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">signer_seeds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="p">[</span><span class="sa">b</span><span class="s">&#34;vault&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">signer_key</span><span class="p">.</span><span class="n">as_ref</span><span class="p">(),</span><span class="w"> </span><span class="o">&amp;</span><span class="p">[</span><span class="n">ctx</span><span class="p">.</span><span class="n">bumps</span><span class="p">.</span><span class="n">vault</span><span class="p">]];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// Transfer all lamports from vault to signer
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">transfer</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">CpiContext</span>::<span class="n">new_with_signer</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">ctx</span><span class="p">.</span><span class="n">accounts</span><span class="p">.</span><span class="n">system_program</span><span class="p">.</span><span class="n">to_account_info</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">Transfer</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">from</span>: <span class="nc">ctx</span><span class="p">.</span><span class="n">accounts</span><span class="p">.</span><span class="n">vault</span><span class="p">.</span><span class="n">to_account_info</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">to</span>: <span class="nc">ctx</span><span class="p">.</span><span class="n">accounts</span><span class="p">.</span><span class="n">signer</span><span class="p">.</span><span class="n">to_account_info</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="o">&amp;</span><span class="p">[</span><span class="o">&amp;</span><span class="n">signer_seeds</span><span class="p">[</span><span class="o">..</span><span class="p">]]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">ctx</span><span class="p">.</span><span class="n">accounts</span><span class="p">.</span><span class="n">vault</span><span class="p">.</span><span class="n">lamports</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">)</span><span class="o">?</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nb">Ok</span><span class="p">(())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="cp">#[derive(Accounts)]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="k">pub</span><span class="w"> </span><span class="k">struct</span> <span class="nc">VaultAction</span><span class="o">&lt;</span><span class="na">&#39;info</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cp">#[account(mut)]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="n">signer</span>: <span class="nc">Signer</span><span class="o">&lt;</span><span class="na">&#39;info</span><span class="o">&gt;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cp">#[account(
</span></span></span><span class="line"><span class="cl"><span class="cp">        mut,
</span></span></span><span class="line"><span class="cl"><span class="cp">        seeds = [b</span><span class="s">&#34;vault&#34;</span><span class="cp">, signer.key().as_ref()],
</span></span></span><span class="line"><span class="cl"><span class="cp">        bump,
</span></span></span><span class="line"><span class="cl"><span class="cp">    )]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="n">vault</span>: <span class="nc">SystemAccount</span><span class="o">&lt;</span><span class="na">&#39;info</span><span class="o">&gt;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="n">system_program</span>: <span class="nc">Program</span><span class="o">&lt;</span><span class="na">&#39;info</span><span class="p">,</span><span class="w"> </span><span class="n">System</span><span class="o">&gt;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="cp">#[error_code]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="k">pub</span><span class="w"> </span><span class="k">enum</span> <span class="nc">VaultError</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cp">#[msg(</span><span class="s">&#34;Vault already exists&#34;</span><span class="cp">)]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">VaultAlreadyExists</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cp">#[msg(</span><span class="s">&#34;Invalid amount&#34;</span><span class="cp">)]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">InvalidAmount</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><div class="mb-collapse-overlay">
        <button class="mb-expand-trigger">
          <i class="fas fa-chevron-down"></i>
          <span>Click to expand</span>
        </button>
      </div></div>
</div>

<script>
(function() {
  'use strict';
  
  const codeblock = document.getElementById('cb-5feceb66');
  if (!codeblock) return;

  const copyBtn = codeblock.querySelector('.mb-copy-btn');
  const collapseBtn = codeblock.querySelector('.mb-collapse-btn');
  const content = codeblock.querySelector('.mb-codeblock-content');
  const overlay = codeblock.querySelector('.mb-collapse-overlay');
  const expandTrigger = overlay?.querySelector('.mb-expand-trigger');

  
  
  
  if (copyBtn) {
    copyBtn.addEventListener('click', async function() {
      let codeText = '';

      
      const codeCell = codeblock.querySelector('.lntd:last-child code');
      if (codeCell) {
        codeText = codeCell.textContent || codeCell.innerText || '';
      } else {
        
        const codeEl = codeblock.querySelector('pre code');
        codeText = codeEl ? (codeEl.textContent || codeEl.innerText || '') : '';
      }

      try {
        await navigator.clipboard.writeText(codeText.trim());
        
        
        const originalHTML = copyBtn.innerHTML;
        copyBtn.innerHTML = '<i class="fas fa-check"></i><span>Copied!</span>';
        copyBtn.classList.add('mb-btn-success');
        
        setTimeout(() => {
          copyBtn.innerHTML = originalHTML;
          copyBtn.classList.remove('mb-btn-success');
        }, 2000);
      } catch (err) {
        console.error('Failed to copy code:', err);
        
        
        const textArea = document.createElement('textarea');
        textArea.value = codeText.trim();
        textArea.style.position = 'fixed';
        textArea.style.opacity = '0';
        document.body.appendChild(textArea);
        textArea.select();
        
        try {
          document.execCommand('copy');
          copyBtn.innerHTML = '<i class="fas fa-check"></i><span>Copied!</span>';
          setTimeout(() => {
            copyBtn.innerHTML = '<i class="fas fa-copy"></i><span>Copy</span>';
          }, 2000);
        } catch (fallbackErr) {
          console.error('Fallback copy failed:', fallbackErr);
        }
        
        document.body.removeChild(textArea);
      }
    });
  }

  
  
  
  if (collapseBtn && content && overlay) {
    const collapsedHeight =  200 ;
    
    function toggleCollapse() {
      const isCollapsed = content.dataset.state === 'collapsed';
      
      if (isCollapsed) {
        
        content.style.maxHeight = '';
        content.style.overflow = '';
        content.dataset.state = 'expanded';
        overlay.style.display = 'none';
        collapseBtn.innerHTML = '<i class="fas fa-compress-alt"></i><span>Collapse</span>';
        collapseBtn.dataset.collapsed = 'false';
      } else {
        
        content.style.maxHeight = collapsedHeight + 'px';
        content.style.overflow = 'hidden';
        content.dataset.state = 'collapsed';
        overlay.style.display = 'flex';
        collapseBtn.innerHTML = '<i class="fas fa-expand-alt"></i><span>Expand</span>';
        collapseBtn.dataset.collapsed = 'true';
      }
    }

    
    if ('expanded' === 'collapsed') {
      content.dataset.state = 'collapsed';
      overlay.style.display = 'flex';
      collapseBtn.innerHTML = '<i class="fas fa-expand-alt"></i><span>Expand</span>';
      collapseBtn.dataset.collapsed = 'true';
    }

    collapseBtn.addEventListener('click', toggleCollapse);
    
    if (expandTrigger) {
      expandTrigger.addEventListener('click', toggleCollapse);
    }
  }
})();
</script>

<style>
 

.mb-codeblock-filename {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  color: var(--color-text);
  font-size: 0.75rem;
  font-weight: 500;
  padding: 0.2rem 0.6rem;
  border-radius: 0.35rem;
  background: color-mix(in srgb, var(--color-bg) 40%, transparent);
  border: 1px solid color-mix(in srgb, var(--color-border) 60%, transparent);
}

.mb-action-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  background: transparent;
  border: 1px solid color-mix(in srgb, var(--color-border) 70%, transparent);
  color: var(--color-text-muted);
  cursor: pointer;
  font-size: 0.7rem;
  padding: 0.35rem 0.65rem;
  border-radius: 0.4rem;
  transition: all 0.15s ease-out;
  font-family: inherit;
}

.mb-action-btn:hover {
  color: var(--color-accent);
  background: color-mix(in srgb, var(--color-accent) 12%, transparent);
  border-color: var(--color-accent);
  transform: translateY(-1px);
}

.mb-action-btn:active {
  transform: translateY(0);
}

.mb-action-btn i {
  font-size: 0.7rem;
}

.mb-btn-success {
  color: #22c55e !important;
  border-color: #22c55e !important;
  background: color-mix(in srgb, #22c55e 12%, transparent) !important;
}

.mb-collapse-overlay {
  display: none;
  position: absolute;
  inset: 0;
  background: linear-gradient(
    to bottom,
    transparent 0%,
    rgba(0, 0, 0, 0.3) 40%,
    rgba(0, 0, 0, 0.85) 100%
  );
  align-items: flex-end;
  justify-content: center;
  padding-bottom: 1rem;
  cursor: pointer;
  z-index: 10;
}

.mb-expand-trigger {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  padding: 0.4rem 0.8rem;
  border-radius: 0.5rem;
  border: 1px solid var(--color-accent);
  background: color-mix(in srgb, var(--color-accent) 20%, transparent);
  color: var(--color-accent);
  font-size: 0.75rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s ease-out;
  backdrop-filter: blur(8px);
}

.mb-expand-trigger:hover {
  background: color-mix(in srgb, var(--color-accent) 30%, transparent);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(168, 85, 247, 0.3);
}

.mb-expand-trigger i {
  font-size: 0.7rem;
  animation: bounce 1.5s infinite;
}

@keyframes bounce {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(3px);
  }
}

 
.mb-codeblock[data-lang="javascript"] .mb-codeblock-badge,
.mb-codeblock[data-lang="js"] .mb-codeblock-badge {
  background: color-mix(in srgb, #f7df1e 25%, transparent);
  color: #f7df1e;
}

.mb-codeblock[data-lang="typescript"] .mb-codeblock-badge,
.mb-codeblock[data-lang="ts"] .mb-codeblock-badge {
  background: color-mix(in srgb, #3178c6 25%, transparent);
  color: #3178c6;
}

.mb-codeblock[data-lang="python"] .mb-codeblock-badge,
.mb-codeblock[data-lang="py"] .mb-codeblock-badge {
  background: color-mix(in srgb, #3776ab 25%, transparent);
  color: #3776ab;
}

.mb-codeblock[data-lang="go"] .mb-codeblock-badge {
  background: color-mix(in srgb, #00add8 25%, transparent);
  color: #00add8;
}

.mb-codeblock[data-lang="rust"] .mb-codeblock-badge,
.mb-codeblock[data-lang="rs"] .mb-codeblock-badge {
  background: color-mix(in srgb, #ce422b 25%, transparent);
  color: #ce422b;
}

.mb-codeblock[data-lang="html"] .mb-codeblock-badge {
  background: color-mix(in srgb, #e34c26 25%, transparent);
  color: #e34c26;
}

.mb-codeblock[data-lang="css"] .mb-codeblock-badge {
  background: color-mix(in srgb, #264de4 25%, transparent);
  color: #264de4;
}

.mb-codeblock[data-lang="bash"] .mb-codeblock-badge,
.mb-codeblock[data-lang="sh"] .mb-codeblock-badge,
.mb-codeblock[data-lang="shell"] .mb-codeblock-badge {
  background: color-mix(in srgb, #4eaa25 25%, transparent);
  color: #4eaa25;
}

.mb-codeblock[data-lang="json"] .mb-codeblock-badge {
  background: color-mix(in srgb, #000000 25%, transparent);
  color: #dddddd;
}

.mb-codeblock[data-lang="yaml"] .mb-codeblock-badge,
.mb-codeblock[data-lang="yml"] .mb-codeblock-badge {
  background: color-mix(in srgb, #cb171e 25%, transparent);
  color: #cb171e;
}
</style><p>The vault supports:</p>
<ul>
<li>Token deposits</li>
<li>Token withdrawals</li>
<li>Internal accounting</li>
</ul>
<p>Even simple vaults can hide subtle accounting bugs when subjected to adversarial sequences. Currently I am not using vulnerable vault code just want to show you flow of fuzzing.</p>
<h4 id="designing-the-fuzz-test-setup">
  <a href="#designing-the-fuzz-test-setup" class="md-heading-anchor">
    Designing the Fuzz Test Setup
  </a>
</h4>
<p>In the root of your vault program repo run the following trident command:</p>
<div class="mb-codeblock" id="cb-6b86b273" data-lang="text">
  
  <div class="mb-codeblock-header">
    <div class="mb-codeblock-left">
      <span class="mb-codeblock-badge">
        TEXT
      </span></div>

    <div class="mb-codeblock-actions"><button class="mb-action-btn mb-collapse-btn" data-collapsed="false" aria-label="Collapse code">
          <i class="fas fa-compress-alt"></i>
          <span>Collapse</span>
        </button><button class="mb-action-btn mb-copy-btn" aria-label="Copy code">
        <i class="fas fa-copy"></i>
        <span>Copy</span>
      </button>
    </div>
  </div>

  
  <div 
    class="mb-codeblock-content" 
    data-state="expanded"
  >
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">trident init </span></span></code></pre></div><div class="mb-collapse-overlay">
        <button class="mb-expand-trigger">
          <i class="fas fa-chevron-down"></i>
          <span>Click to expand</span>
        </button>
      </div></div>
</div>

<script>
(function() {
  'use strict';
  
  const codeblock = document.getElementById('cb-6b86b273');
  if (!codeblock) return;

  const copyBtn = codeblock.querySelector('.mb-copy-btn');
  const collapseBtn = codeblock.querySelector('.mb-collapse-btn');
  const content = codeblock.querySelector('.mb-codeblock-content');
  const overlay = codeblock.querySelector('.mb-collapse-overlay');
  const expandTrigger = overlay?.querySelector('.mb-expand-trigger');

  
  
  
  if (copyBtn) {
    copyBtn.addEventListener('click', async function() {
      let codeText = '';

      
      const codeCell = codeblock.querySelector('.lntd:last-child code');
      if (codeCell) {
        codeText = codeCell.textContent || codeCell.innerText || '';
      } else {
        
        const codeEl = codeblock.querySelector('pre code');
        codeText = codeEl ? (codeEl.textContent || codeEl.innerText || '') : '';
      }

      try {
        await navigator.clipboard.writeText(codeText.trim());
        
        
        const originalHTML = copyBtn.innerHTML;
        copyBtn.innerHTML = '<i class="fas fa-check"></i><span>Copied!</span>';
        copyBtn.classList.add('mb-btn-success');
        
        setTimeout(() => {
          copyBtn.innerHTML = originalHTML;
          copyBtn.classList.remove('mb-btn-success');
        }, 2000);
      } catch (err) {
        console.error('Failed to copy code:', err);
        
        
        const textArea = document.createElement('textarea');
        textArea.value = codeText.trim();
        textArea.style.position = 'fixed';
        textArea.style.opacity = '0';
        document.body.appendChild(textArea);
        textArea.select();
        
        try {
          document.execCommand('copy');
          copyBtn.innerHTML = '<i class="fas fa-check"></i><span>Copied!</span>';
          setTimeout(() => {
            copyBtn.innerHTML = '<i class="fas fa-copy"></i><span>Copy</span>';
          }, 2000);
        } catch (fallbackErr) {
          console.error('Fallback copy failed:', fallbackErr);
        }
        
        document.body.removeChild(textArea);
      }
    });
  }

  
  
  
  if (collapseBtn && content && overlay) {
    const collapsedHeight =  200 ;
    
    function toggleCollapse() {
      const isCollapsed = content.dataset.state === 'collapsed';
      
      if (isCollapsed) {
        
        content.style.maxHeight = '';
        content.style.overflow = '';
        content.dataset.state = 'expanded';
        overlay.style.display = 'none';
        collapseBtn.innerHTML = '<i class="fas fa-compress-alt"></i><span>Collapse</span>';
        collapseBtn.dataset.collapsed = 'false';
      } else {
        
        content.style.maxHeight = collapsedHeight + 'px';
        content.style.overflow = 'hidden';
        content.dataset.state = 'collapsed';
        overlay.style.display = 'flex';
        collapseBtn.innerHTML = '<i class="fas fa-expand-alt"></i><span>Expand</span>';
        collapseBtn.dataset.collapsed = 'true';
      }
    }

    
    if ('expanded' === 'collapsed') {
      content.dataset.state = 'collapsed';
      overlay.style.display = 'flex';
      collapseBtn.innerHTML = '<i class="fas fa-expand-alt"></i><span>Expand</span>';
      collapseBtn.dataset.collapsed = 'true';
    }

    collapseBtn.addEventListener('click', toggleCollapse);
    
    if (expandTrigger) {
      expandTrigger.addEventListener('click', toggleCollapse);
    }
  }
})();
</script>

<style>
 

.mb-codeblock-filename {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  color: var(--color-text);
  font-size: 0.75rem;
  font-weight: 500;
  padding: 0.2rem 0.6rem;
  border-radius: 0.35rem;
  background: color-mix(in srgb, var(--color-bg) 40%, transparent);
  border: 1px solid color-mix(in srgb, var(--color-border) 60%, transparent);
}

.mb-action-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  background: transparent;
  border: 1px solid color-mix(in srgb, var(--color-border) 70%, transparent);
  color: var(--color-text-muted);
  cursor: pointer;
  font-size: 0.7rem;
  padding: 0.35rem 0.65rem;
  border-radius: 0.4rem;
  transition: all 0.15s ease-out;
  font-family: inherit;
}

.mb-action-btn:hover {
  color: var(--color-accent);
  background: color-mix(in srgb, var(--color-accent) 12%, transparent);
  border-color: var(--color-accent);
  transform: translateY(-1px);
}

.mb-action-btn:active {
  transform: translateY(0);
}

.mb-action-btn i {
  font-size: 0.7rem;
}

.mb-btn-success {
  color: #22c55e !important;
  border-color: #22c55e !important;
  background: color-mix(in srgb, #22c55e 12%, transparent) !important;
}

.mb-collapse-overlay {
  display: none;
  position: absolute;
  inset: 0;
  background: linear-gradient(
    to bottom,
    transparent 0%,
    rgba(0, 0, 0, 0.3) 40%,
    rgba(0, 0, 0, 0.85) 100%
  );
  align-items: flex-end;
  justify-content: center;
  padding-bottom: 1rem;
  cursor: pointer;
  z-index: 10;
}

.mb-expand-trigger {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  padding: 0.4rem 0.8rem;
  border-radius: 0.5rem;
  border: 1px solid var(--color-accent);
  background: color-mix(in srgb, var(--color-accent) 20%, transparent);
  color: var(--color-accent);
  font-size: 0.75rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s ease-out;
  backdrop-filter: blur(8px);
}

.mb-expand-trigger:hover {
  background: color-mix(in srgb, var(--color-accent) 30%, transparent);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(168, 85, 247, 0.3);
}

.mb-expand-trigger i {
  font-size: 0.7rem;
  animation: bounce 1.5s infinite;
}

@keyframes bounce {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(3px);
  }
}

 
.mb-codeblock[data-lang="javascript"] .mb-codeblock-badge,
.mb-codeblock[data-lang="js"] .mb-codeblock-badge {
  background: color-mix(in srgb, #f7df1e 25%, transparent);
  color: #f7df1e;
}

.mb-codeblock[data-lang="typescript"] .mb-codeblock-badge,
.mb-codeblock[data-lang="ts"] .mb-codeblock-badge {
  background: color-mix(in srgb, #3178c6 25%, transparent);
  color: #3178c6;
}

.mb-codeblock[data-lang="python"] .mb-codeblock-badge,
.mb-codeblock[data-lang="py"] .mb-codeblock-badge {
  background: color-mix(in srgb, #3776ab 25%, transparent);
  color: #3776ab;
}

.mb-codeblock[data-lang="go"] .mb-codeblock-badge {
  background: color-mix(in srgb, #00add8 25%, transparent);
  color: #00add8;
}

.mb-codeblock[data-lang="rust"] .mb-codeblock-badge,
.mb-codeblock[data-lang="rs"] .mb-codeblock-badge {
  background: color-mix(in srgb, #ce422b 25%, transparent);
  color: #ce422b;
}

.mb-codeblock[data-lang="html"] .mb-codeblock-badge {
  background: color-mix(in srgb, #e34c26 25%, transparent);
  color: #e34c26;
}

.mb-codeblock[data-lang="css"] .mb-codeblock-badge {
  background: color-mix(in srgb, #264de4 25%, transparent);
  color: #264de4;
}

.mb-codeblock[data-lang="bash"] .mb-codeblock-badge,
.mb-codeblock[data-lang="sh"] .mb-codeblock-badge,
.mb-codeblock[data-lang="shell"] .mb-codeblock-badge {
  background: color-mix(in srgb, #4eaa25 25%, transparent);
  color: #4eaa25;
}

.mb-codeblock[data-lang="json"] .mb-codeblock-badge {
  background: color-mix(in srgb, #000000 25%, transparent);
  color: #dddddd;
}

.mb-codeblock[data-lang="yaml"] .mb-codeblock-badge,
.mb-codeblock[data-lang="yml"] .mb-codeblock-badge {
  background: color-mix(in srgb, #cb171e 25%, transparent);
  color: #cb171e;
}
</style><p>If the command passes then it&rsquo;ll create <code>trident-tests</code> folder with following structure:</p>
<div class="mb-codeblock" id="cb-d4735e3a" data-lang="text">
  
  <div class="mb-codeblock-header">
    <div class="mb-codeblock-left">
      <span class="mb-codeblock-badge">
        TEXT
      </span></div>

    <div class="mb-codeblock-actions"><button class="mb-action-btn mb-collapse-btn" data-collapsed="false" aria-label="Collapse code">
          <i class="fas fa-compress-alt"></i>
          <span>Collapse</span>
        </button><button class="mb-action-btn mb-copy-btn" aria-label="Copy code">
        <i class="fas fa-copy"></i>
        <span>Copy</span>
      </button>
    </div>
  </div>

  
  <div 
    class="mb-codeblock-content" 
    data-state="expanded"
  >
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">project-root
</span></span><span class="line"><span class="cl">├── trident-tests
</span></span><span class="line"><span class="cl">│   ├── .fuzz-artifacts         # Fuzzing artifacts (dashboard, metrics, etc.)
</span></span><span class="line"><span class="cl">│   ├── fuzz_0                  # Your first fuzz test
</span></span><span class="line"><span class="cl">│   │   ├── test_fuzz.rs        # Main fuzz test logic
</span></span><span class="line"><span class="cl">│   │   ├── fuzz_accounts.rs    # Account addresses storage
</span></span><span class="line"><span class="cl">│   │   └── types.rs            # IDL-like generated types
</span></span><span class="line"><span class="cl">│   ├── fuzz_1                  # Additional fuzz tests
</span></span><span class="line"><span class="cl">│   ├── fuzz_X                  # Multiple fuzz tests supported
</span></span><span class="line"><span class="cl">│   ├── fuzzing                 # Compilation and crash artifacts
</span></span><span class="line"><span class="cl">│   ├── Cargo.toml              # Rust dependencies
</span></span><span class="line"><span class="cl">│   └── Trident.toml            # Trident configuration
</span></span><span class="line"><span class="cl">└── ...</span></span></code></pre></div><div class="mb-collapse-overlay">
        <button class="mb-expand-trigger">
          <i class="fas fa-chevron-down"></i>
          <span>Click to expand</span>
        </button>
      </div></div>
</div>

<script>
(function() {
  'use strict';
  
  const codeblock = document.getElementById('cb-d4735e3a');
  if (!codeblock) return;

  const copyBtn = codeblock.querySelector('.mb-copy-btn');
  const collapseBtn = codeblock.querySelector('.mb-collapse-btn');
  const content = codeblock.querySelector('.mb-codeblock-content');
  const overlay = codeblock.querySelector('.mb-collapse-overlay');
  const expandTrigger = overlay?.querySelector('.mb-expand-trigger');

  
  
  
  if (copyBtn) {
    copyBtn.addEventListener('click', async function() {
      let codeText = '';

      
      const codeCell = codeblock.querySelector('.lntd:last-child code');
      if (codeCell) {
        codeText = codeCell.textContent || codeCell.innerText || '';
      } else {
        
        const codeEl = codeblock.querySelector('pre code');
        codeText = codeEl ? (codeEl.textContent || codeEl.innerText || '') : '';
      }

      try {
        await navigator.clipboard.writeText(codeText.trim());
        
        
        const originalHTML = copyBtn.innerHTML;
        copyBtn.innerHTML = '<i class="fas fa-check"></i><span>Copied!</span>';
        copyBtn.classList.add('mb-btn-success');
        
        setTimeout(() => {
          copyBtn.innerHTML = originalHTML;
          copyBtn.classList.remove('mb-btn-success');
        }, 2000);
      } catch (err) {
        console.error('Failed to copy code:', err);
        
        
        const textArea = document.createElement('textarea');
        textArea.value = codeText.trim();
        textArea.style.position = 'fixed';
        textArea.style.opacity = '0';
        document.body.appendChild(textArea);
        textArea.select();
        
        try {
          document.execCommand('copy');
          copyBtn.innerHTML = '<i class="fas fa-check"></i><span>Copied!</span>';
          setTimeout(() => {
            copyBtn.innerHTML = '<i class="fas fa-copy"></i><span>Copy</span>';
          }, 2000);
        } catch (fallbackErr) {
          console.error('Fallback copy failed:', fallbackErr);
        }
        
        document.body.removeChild(textArea);
      }
    });
  }

  
  
  
  if (collapseBtn && content && overlay) {
    const collapsedHeight =  200 ;
    
    function toggleCollapse() {
      const isCollapsed = content.dataset.state === 'collapsed';
      
      if (isCollapsed) {
        
        content.style.maxHeight = '';
        content.style.overflow = '';
        content.dataset.state = 'expanded';
        overlay.style.display = 'none';
        collapseBtn.innerHTML = '<i class="fas fa-compress-alt"></i><span>Collapse</span>';
        collapseBtn.dataset.collapsed = 'false';
      } else {
        
        content.style.maxHeight = collapsedHeight + 'px';
        content.style.overflow = 'hidden';
        content.dataset.state = 'collapsed';
        overlay.style.display = 'flex';
        collapseBtn.innerHTML = '<i class="fas fa-expand-alt"></i><span>Expand</span>';
        collapseBtn.dataset.collapsed = 'true';
      }
    }

    
    if ('expanded' === 'collapsed') {
      content.dataset.state = 'collapsed';
      overlay.style.display = 'flex';
      collapseBtn.innerHTML = '<i class="fas fa-expand-alt"></i><span>Expand</span>';
      collapseBtn.dataset.collapsed = 'true';
    }

    collapseBtn.addEventListener('click', toggleCollapse);
    
    if (expandTrigger) {
      expandTrigger.addEventListener('click', toggleCollapse);
    }
  }
})();
</script>

<style>
 

.mb-codeblock-filename {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  color: var(--color-text);
  font-size: 0.75rem;
  font-weight: 500;
  padding: 0.2rem 0.6rem;
  border-radius: 0.35rem;
  background: color-mix(in srgb, var(--color-bg) 40%, transparent);
  border: 1px solid color-mix(in srgb, var(--color-border) 60%, transparent);
}

.mb-action-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  background: transparent;
  border: 1px solid color-mix(in srgb, var(--color-border) 70%, transparent);
  color: var(--color-text-muted);
  cursor: pointer;
  font-size: 0.7rem;
  padding: 0.35rem 0.65rem;
  border-radius: 0.4rem;
  transition: all 0.15s ease-out;
  font-family: inherit;
}

.mb-action-btn:hover {
  color: var(--color-accent);
  background: color-mix(in srgb, var(--color-accent) 12%, transparent);
  border-color: var(--color-accent);
  transform: translateY(-1px);
}

.mb-action-btn:active {
  transform: translateY(0);
}

.mb-action-btn i {
  font-size: 0.7rem;
}

.mb-btn-success {
  color: #22c55e !important;
  border-color: #22c55e !important;
  background: color-mix(in srgb, #22c55e 12%, transparent) !important;
}

.mb-collapse-overlay {
  display: none;
  position: absolute;
  inset: 0;
  background: linear-gradient(
    to bottom,
    transparent 0%,
    rgba(0, 0, 0, 0.3) 40%,
    rgba(0, 0, 0, 0.85) 100%
  );
  align-items: flex-end;
  justify-content: center;
  padding-bottom: 1rem;
  cursor: pointer;
  z-index: 10;
}

.mb-expand-trigger {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  padding: 0.4rem 0.8rem;
  border-radius: 0.5rem;
  border: 1px solid var(--color-accent);
  background: color-mix(in srgb, var(--color-accent) 20%, transparent);
  color: var(--color-accent);
  font-size: 0.75rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s ease-out;
  backdrop-filter: blur(8px);
}

.mb-expand-trigger:hover {
  background: color-mix(in srgb, var(--color-accent) 30%, transparent);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(168, 85, 247, 0.3);
}

.mb-expand-trigger i {
  font-size: 0.7rem;
  animation: bounce 1.5s infinite;
}

@keyframes bounce {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(3px);
  }
}

 
.mb-codeblock[data-lang="javascript"] .mb-codeblock-badge,
.mb-codeblock[data-lang="js"] .mb-codeblock-badge {
  background: color-mix(in srgb, #f7df1e 25%, transparent);
  color: #f7df1e;
}

.mb-codeblock[data-lang="typescript"] .mb-codeblock-badge,
.mb-codeblock[data-lang="ts"] .mb-codeblock-badge {
  background: color-mix(in srgb, #3178c6 25%, transparent);
  color: #3178c6;
}

.mb-codeblock[data-lang="python"] .mb-codeblock-badge,
.mb-codeblock[data-lang="py"] .mb-codeblock-badge {
  background: color-mix(in srgb, #3776ab 25%, transparent);
  color: #3776ab;
}

.mb-codeblock[data-lang="go"] .mb-codeblock-badge {
  background: color-mix(in srgb, #00add8 25%, transparent);
  color: #00add8;
}

.mb-codeblock[data-lang="rust"] .mb-codeblock-badge,
.mb-codeblock[data-lang="rs"] .mb-codeblock-badge {
  background: color-mix(in srgb, #ce422b 25%, transparent);
  color: #ce422b;
}

.mb-codeblock[data-lang="html"] .mb-codeblock-badge {
  background: color-mix(in srgb, #e34c26 25%, transparent);
  color: #e34c26;
}

.mb-codeblock[data-lang="css"] .mb-codeblock-badge {
  background: color-mix(in srgb, #264de4 25%, transparent);
  color: #264de4;
}

.mb-codeblock[data-lang="bash"] .mb-codeblock-badge,
.mb-codeblock[data-lang="sh"] .mb-codeblock-badge,
.mb-codeblock[data-lang="shell"] .mb-codeblock-badge {
  background: color-mix(in srgb, #4eaa25 25%, transparent);
  color: #4eaa25;
}

.mb-codeblock[data-lang="json"] .mb-codeblock-badge {
  background: color-mix(in srgb, #000000 25%, transparent);
  color: #dddddd;
}

.mb-codeblock[data-lang="yaml"] .mb-codeblock-badge,
.mb-codeblock[data-lang="yml"] .mb-codeblock-badge {
  background: color-mix(in srgb, #cb171e 25%, transparent);
  color: #cb171e;
}
</style><p>The <code>fuzz_accounts.rs</code> file contains all the accounts that are in the program code. The <code>types.rs</code> file contains IDL-like generated types of the complete program.</p>
<p>Currently we only care about <code>test_fuzz.rs</code> file present in the <code>fuzz_0</code> folder. The current empty <code>test_fuzz.rs</code> might look something like this:</p>
<div class="mb-codeblock" id="cb-4e074085" data-lang="rust">
  
  <div class="mb-codeblock-header">
    <div class="mb-codeblock-left">
      <span class="mb-codeblock-badge">
        RUST
      </span></div>

    <div class="mb-codeblock-actions"><button class="mb-action-btn mb-collapse-btn" data-collapsed="false" aria-label="Collapse code">
          <i class="fas fa-compress-alt"></i>
          <span>Collapse</span>
        </button><button class="mb-action-btn mb-copy-btn" aria-label="Copy code">
        <i class="fas fa-copy"></i>
        <span>Copy</span>
      </button>
    </div>
  </div>

  
  <div 
    class="mb-codeblock-content" 
    data-state="expanded"
  >
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="w">    </span><span class="cp">#[init]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">start</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// perform any initialization here, this method will be executed
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// at start of each iteration
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cp">#[flow]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">flow1</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// perform logic which is meant to be fuzzed
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// this flow is selected randomly from other flows
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cp">#[end]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">end</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// perform any cleaning here, this method will be executed
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// at the end of each iteration
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span></span></span></code></pre></div><div class="mb-collapse-overlay">
        <button class="mb-expand-trigger">
          <i class="fas fa-chevron-down"></i>
          <span>Click to expand</span>
        </button>
      </div></div>
</div>

<script>
(function() {
  'use strict';
  
  const codeblock = document.getElementById('cb-4e074085');
  if (!codeblock) return;

  const copyBtn = codeblock.querySelector('.mb-copy-btn');
  const collapseBtn = codeblock.querySelector('.mb-collapse-btn');
  const content = codeblock.querySelector('.mb-codeblock-content');
  const overlay = codeblock.querySelector('.mb-collapse-overlay');
  const expandTrigger = overlay?.querySelector('.mb-expand-trigger');

  
  
  
  if (copyBtn) {
    copyBtn.addEventListener('click', async function() {
      let codeText = '';

      
      const codeCell = codeblock.querySelector('.lntd:last-child code');
      if (codeCell) {
        codeText = codeCell.textContent || codeCell.innerText || '';
      } else {
        
        const codeEl = codeblock.querySelector('pre code');
        codeText = codeEl ? (codeEl.textContent || codeEl.innerText || '') : '';
      }

      try {
        await navigator.clipboard.writeText(codeText.trim());
        
        
        const originalHTML = copyBtn.innerHTML;
        copyBtn.innerHTML = '<i class="fas fa-check"></i><span>Copied!</span>';
        copyBtn.classList.add('mb-btn-success');
        
        setTimeout(() => {
          copyBtn.innerHTML = originalHTML;
          copyBtn.classList.remove('mb-btn-success');
        }, 2000);
      } catch (err) {
        console.error('Failed to copy code:', err);
        
        
        const textArea = document.createElement('textarea');
        textArea.value = codeText.trim();
        textArea.style.position = 'fixed';
        textArea.style.opacity = '0';
        document.body.appendChild(textArea);
        textArea.select();
        
        try {
          document.execCommand('copy');
          copyBtn.innerHTML = '<i class="fas fa-check"></i><span>Copied!</span>';
          setTimeout(() => {
            copyBtn.innerHTML = '<i class="fas fa-copy"></i><span>Copy</span>';
          }, 2000);
        } catch (fallbackErr) {
          console.error('Fallback copy failed:', fallbackErr);
        }
        
        document.body.removeChild(textArea);
      }
    });
  }

  
  
  
  if (collapseBtn && content && overlay) {
    const collapsedHeight =  200 ;
    
    function toggleCollapse() {
      const isCollapsed = content.dataset.state === 'collapsed';
      
      if (isCollapsed) {
        
        content.style.maxHeight = '';
        content.style.overflow = '';
        content.dataset.state = 'expanded';
        overlay.style.display = 'none';
        collapseBtn.innerHTML = '<i class="fas fa-compress-alt"></i><span>Collapse</span>';
        collapseBtn.dataset.collapsed = 'false';
      } else {
        
        content.style.maxHeight = collapsedHeight + 'px';
        content.style.overflow = 'hidden';
        content.dataset.state = 'collapsed';
        overlay.style.display = 'flex';
        collapseBtn.innerHTML = '<i class="fas fa-expand-alt"></i><span>Expand</span>';
        collapseBtn.dataset.collapsed = 'true';
      }
    }

    
    if ('expanded' === 'collapsed') {
      content.dataset.state = 'collapsed';
      overlay.style.display = 'flex';
      collapseBtn.innerHTML = '<i class="fas fa-expand-alt"></i><span>Expand</span>';
      collapseBtn.dataset.collapsed = 'true';
    }

    collapseBtn.addEventListener('click', toggleCollapse);
    
    if (expandTrigger) {
      expandTrigger.addEventListener('click', toggleCollapse);
    }
  }
})();
</script>

<style>
 

.mb-codeblock-filename {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  color: var(--color-text);
  font-size: 0.75rem;
  font-weight: 500;
  padding: 0.2rem 0.6rem;
  border-radius: 0.35rem;
  background: color-mix(in srgb, var(--color-bg) 40%, transparent);
  border: 1px solid color-mix(in srgb, var(--color-border) 60%, transparent);
}

.mb-action-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  background: transparent;
  border: 1px solid color-mix(in srgb, var(--color-border) 70%, transparent);
  color: var(--color-text-muted);
  cursor: pointer;
  font-size: 0.7rem;
  padding: 0.35rem 0.65rem;
  border-radius: 0.4rem;
  transition: all 0.15s ease-out;
  font-family: inherit;
}

.mb-action-btn:hover {
  color: var(--color-accent);
  background: color-mix(in srgb, var(--color-accent) 12%, transparent);
  border-color: var(--color-accent);
  transform: translateY(-1px);
}

.mb-action-btn:active {
  transform: translateY(0);
}

.mb-action-btn i {
  font-size: 0.7rem;
}

.mb-btn-success {
  color: #22c55e !important;
  border-color: #22c55e !important;
  background: color-mix(in srgb, #22c55e 12%, transparent) !important;
}

.mb-collapse-overlay {
  display: none;
  position: absolute;
  inset: 0;
  background: linear-gradient(
    to bottom,
    transparent 0%,
    rgba(0, 0, 0, 0.3) 40%,
    rgba(0, 0, 0, 0.85) 100%
  );
  align-items: flex-end;
  justify-content: center;
  padding-bottom: 1rem;
  cursor: pointer;
  z-index: 10;
}

.mb-expand-trigger {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  padding: 0.4rem 0.8rem;
  border-radius: 0.5rem;
  border: 1px solid var(--color-accent);
  background: color-mix(in srgb, var(--color-accent) 20%, transparent);
  color: var(--color-accent);
  font-size: 0.75rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s ease-out;
  backdrop-filter: blur(8px);
}

.mb-expand-trigger:hover {
  background: color-mix(in srgb, var(--color-accent) 30%, transparent);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(168, 85, 247, 0.3);
}

.mb-expand-trigger i {
  font-size: 0.7rem;
  animation: bounce 1.5s infinite;
}

@keyframes bounce {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(3px);
  }
}

 
.mb-codeblock[data-lang="javascript"] .mb-codeblock-badge,
.mb-codeblock[data-lang="js"] .mb-codeblock-badge {
  background: color-mix(in srgb, #f7df1e 25%, transparent);
  color: #f7df1e;
}

.mb-codeblock[data-lang="typescript"] .mb-codeblock-badge,
.mb-codeblock[data-lang="ts"] .mb-codeblock-badge {
  background: color-mix(in srgb, #3178c6 25%, transparent);
  color: #3178c6;
}

.mb-codeblock[data-lang="python"] .mb-codeblock-badge,
.mb-codeblock[data-lang="py"] .mb-codeblock-badge {
  background: color-mix(in srgb, #3776ab 25%, transparent);
  color: #3776ab;
}

.mb-codeblock[data-lang="go"] .mb-codeblock-badge {
  background: color-mix(in srgb, #00add8 25%, transparent);
  color: #00add8;
}

.mb-codeblock[data-lang="rust"] .mb-codeblock-badge,
.mb-codeblock[data-lang="rs"] .mb-codeblock-badge {
  background: color-mix(in srgb, #ce422b 25%, transparent);
  color: #ce422b;
}

.mb-codeblock[data-lang="html"] .mb-codeblock-badge {
  background: color-mix(in srgb, #e34c26 25%, transparent);
  color: #e34c26;
}

.mb-codeblock[data-lang="css"] .mb-codeblock-badge {
  background: color-mix(in srgb, #264de4 25%, transparent);
  color: #264de4;
}

.mb-codeblock[data-lang="bash"] .mb-codeblock-badge,
.mb-codeblock[data-lang="sh"] .mb-codeblock-badge,
.mb-codeblock[data-lang="shell"] .mb-codeblock-badge {
  background: color-mix(in srgb, #4eaa25 25%, transparent);
  color: #4eaa25;
}

.mb-codeblock[data-lang="json"] .mb-codeblock-badge {
  background: color-mix(in srgb, #000000 25%, transparent);
  color: #dddddd;
}

.mb-codeblock[data-lang="yaml"] .mb-codeblock-badge,
.mb-codeblock[data-lang="yml"] .mb-codeblock-badge {
  background: color-mix(in srgb, #cb171e 25%, transparent);
  color: #cb171e;
}
</style><p>As stated in comments of each attribute <code>#[init]</code> with start function is to intialize required minimal setup with which we can start fuzzing.
With <code>#[flow]</code> you can decide which function to performed fuzz on. You can have multiple flows.
The <code>#[end]</code> means any ending function like closing account etc can be executed here.</p>
<h4 id="starting-with-writing-fuzz-test">
  <a href="#starting-with-writing-fuzz-test" class="md-heading-anchor">
    Starting with writing fuzz test
  </a>
</h4>
<p>Add following code in the <code>start()</code> function of <code>#[init]</code> block:</p>
<div class="mb-codeblock" id="cb-4b227777" data-lang="rust">
  
  <div class="mb-codeblock-header">
    <div class="mb-codeblock-left">
      <span class="mb-codeblock-badge">
        RUST
      </span></div>

    <div class="mb-codeblock-actions"><button class="mb-action-btn mb-collapse-btn" data-collapsed="false" aria-label="Collapse code">
          <i class="fas fa-compress-alt"></i>
          <span>Collapse</span>
        </button><button class="mb-action-btn mb-copy-btn" aria-label="Copy code">
        <i class="fas fa-copy"></i>
        <span>Copy</span>
      </button>
    </div>
  </div>

  
  <div 
    class="mb-codeblock-content" 
    data-state="expanded"
  >
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="w">    </span><span class="cp">#[init]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">start</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">signer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">fuzz_accounts</span><span class="p">.</span><span class="n">signer</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">trident</span><span class="p">,</span><span class="w"> </span><span class="nb">None</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">trident</span><span class="p">.</span><span class="n">airdrop</span><span class="p">(</span><span class="o">&amp;</span><span class="n">signer</span><span class="p">,</span><span class="w"> </span><span class="mi">150</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="no">LAMPORTS_PER_SOL</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span></span></span></code></pre></div><div class="mb-collapse-overlay">
        <button class="mb-expand-trigger">
          <i class="fas fa-chevron-down"></i>
          <span>Click to expand</span>
        </button>
      </div></div>
</div>

<script>
(function() {
  'use strict';
  
  const codeblock = document.getElementById('cb-4b227777');
  if (!codeblock) return;

  const copyBtn = codeblock.querySelector('.mb-copy-btn');
  const collapseBtn = codeblock.querySelector('.mb-collapse-btn');
  const content = codeblock.querySelector('.mb-codeblock-content');
  const overlay = codeblock.querySelector('.mb-collapse-overlay');
  const expandTrigger = overlay?.querySelector('.mb-expand-trigger');

  
  
  
  if (copyBtn) {
    copyBtn.addEventListener('click', async function() {
      let codeText = '';

      
      const codeCell = codeblock.querySelector('.lntd:last-child code');
      if (codeCell) {
        codeText = codeCell.textContent || codeCell.innerText || '';
      } else {
        
        const codeEl = codeblock.querySelector('pre code');
        codeText = codeEl ? (codeEl.textContent || codeEl.innerText || '') : '';
      }

      try {
        await navigator.clipboard.writeText(codeText.trim());
        
        
        const originalHTML = copyBtn.innerHTML;
        copyBtn.innerHTML = '<i class="fas fa-check"></i><span>Copied!</span>';
        copyBtn.classList.add('mb-btn-success');
        
        setTimeout(() => {
          copyBtn.innerHTML = originalHTML;
          copyBtn.classList.remove('mb-btn-success');
        }, 2000);
      } catch (err) {
        console.error('Failed to copy code:', err);
        
        
        const textArea = document.createElement('textarea');
        textArea.value = codeText.trim();
        textArea.style.position = 'fixed';
        textArea.style.opacity = '0';
        document.body.appendChild(textArea);
        textArea.select();
        
        try {
          document.execCommand('copy');
          copyBtn.innerHTML = '<i class="fas fa-check"></i><span>Copied!</span>';
          setTimeout(() => {
            copyBtn.innerHTML = '<i class="fas fa-copy"></i><span>Copy</span>';
          }, 2000);
        } catch (fallbackErr) {
          console.error('Fallback copy failed:', fallbackErr);
        }
        
        document.body.removeChild(textArea);
      }
    });
  }

  
  
  
  if (collapseBtn && content && overlay) {
    const collapsedHeight =  200 ;
    
    function toggleCollapse() {
      const isCollapsed = content.dataset.state === 'collapsed';
      
      if (isCollapsed) {
        
        content.style.maxHeight = '';
        content.style.overflow = '';
        content.dataset.state = 'expanded';
        overlay.style.display = 'none';
        collapseBtn.innerHTML = '<i class="fas fa-compress-alt"></i><span>Collapse</span>';
        collapseBtn.dataset.collapsed = 'false';
      } else {
        
        content.style.maxHeight = collapsedHeight + 'px';
        content.style.overflow = 'hidden';
        content.dataset.state = 'collapsed';
        overlay.style.display = 'flex';
        collapseBtn.innerHTML = '<i class="fas fa-expand-alt"></i><span>Expand</span>';
        collapseBtn.dataset.collapsed = 'true';
      }
    }

    
    if ('expanded' === 'collapsed') {
      content.dataset.state = 'collapsed';
      overlay.style.display = 'flex';
      collapseBtn.innerHTML = '<i class="fas fa-expand-alt"></i><span>Expand</span>';
      collapseBtn.dataset.collapsed = 'true';
    }

    collapseBtn.addEventListener('click', toggleCollapse);
    
    if (expandTrigger) {
      expandTrigger.addEventListener('click', toggleCollapse);
    }
  }
})();
</script>

<style>
 

.mb-codeblock-filename {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  color: var(--color-text);
  font-size: 0.75rem;
  font-weight: 500;
  padding: 0.2rem 0.6rem;
  border-radius: 0.35rem;
  background: color-mix(in srgb, var(--color-bg) 40%, transparent);
  border: 1px solid color-mix(in srgb, var(--color-border) 60%, transparent);
}

.mb-action-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  background: transparent;
  border: 1px solid color-mix(in srgb, var(--color-border) 70%, transparent);
  color: var(--color-text-muted);
  cursor: pointer;
  font-size: 0.7rem;
  padding: 0.35rem 0.65rem;
  border-radius: 0.4rem;
  transition: all 0.15s ease-out;
  font-family: inherit;
}

.mb-action-btn:hover {
  color: var(--color-accent);
  background: color-mix(in srgb, var(--color-accent) 12%, transparent);
  border-color: var(--color-accent);
  transform: translateY(-1px);
}

.mb-action-btn:active {
  transform: translateY(0);
}

.mb-action-btn i {
  font-size: 0.7rem;
}

.mb-btn-success {
  color: #22c55e !important;
  border-color: #22c55e !important;
  background: color-mix(in srgb, #22c55e 12%, transparent) !important;
}

.mb-collapse-overlay {
  display: none;
  position: absolute;
  inset: 0;
  background: linear-gradient(
    to bottom,
    transparent 0%,
    rgba(0, 0, 0, 0.3) 40%,
    rgba(0, 0, 0, 0.85) 100%
  );
  align-items: flex-end;
  justify-content: center;
  padding-bottom: 1rem;
  cursor: pointer;
  z-index: 10;
}

.mb-expand-trigger {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  padding: 0.4rem 0.8rem;
  border-radius: 0.5rem;
  border: 1px solid var(--color-accent);
  background: color-mix(in srgb, var(--color-accent) 20%, transparent);
  color: var(--color-accent);
  font-size: 0.75rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s ease-out;
  backdrop-filter: blur(8px);
}

.mb-expand-trigger:hover {
  background: color-mix(in srgb, var(--color-accent) 30%, transparent);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(168, 85, 247, 0.3);
}

.mb-expand-trigger i {
  font-size: 0.7rem;
  animation: bounce 1.5s infinite;
}

@keyframes bounce {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(3px);
  }
}

 
.mb-codeblock[data-lang="javascript"] .mb-codeblock-badge,
.mb-codeblock[data-lang="js"] .mb-codeblock-badge {
  background: color-mix(in srgb, #f7df1e 25%, transparent);
  color: #f7df1e;
}

.mb-codeblock[data-lang="typescript"] .mb-codeblock-badge,
.mb-codeblock[data-lang="ts"] .mb-codeblock-badge {
  background: color-mix(in srgb, #3178c6 25%, transparent);
  color: #3178c6;
}

.mb-codeblock[data-lang="python"] .mb-codeblock-badge,
.mb-codeblock[data-lang="py"] .mb-codeblock-badge {
  background: color-mix(in srgb, #3776ab 25%, transparent);
  color: #3776ab;
}

.mb-codeblock[data-lang="go"] .mb-codeblock-badge {
  background: color-mix(in srgb, #00add8 25%, transparent);
  color: #00add8;
}

.mb-codeblock[data-lang="rust"] .mb-codeblock-badge,
.mb-codeblock[data-lang="rs"] .mb-codeblock-badge {
  background: color-mix(in srgb, #ce422b 25%, transparent);
  color: #ce422b;
}

.mb-codeblock[data-lang="html"] .mb-codeblock-badge {
  background: color-mix(in srgb, #e34c26 25%, transparent);
  color: #e34c26;
}

.mb-codeblock[data-lang="css"] .mb-codeblock-badge {
  background: color-mix(in srgb, #264de4 25%, transparent);
  color: #264de4;
}

.mb-codeblock[data-lang="bash"] .mb-codeblock-badge,
.mb-codeblock[data-lang="sh"] .mb-codeblock-badge,
.mb-codeblock[data-lang="shell"] .mb-codeblock-badge {
  background: color-mix(in srgb, #4eaa25 25%, transparent);
  color: #4eaa25;
}

.mb-codeblock[data-lang="json"] .mb-codeblock-badge {
  background: color-mix(in srgb, #000000 25%, transparent);
  color: #dddddd;
}

.mb-codeblock[data-lang="yaml"] .mb-codeblock-badge,
.mb-codeblock[data-lang="yml"] .mb-codeblock-badge {
  background: color-mix(in srgb, #cb171e 25%, transparent);
  color: #cb171e;
}
</style><p>As I said above we only need minimal setup to start actual fuzzing. In the block we are initializing the <code>signer</code> address from <code>fuzz_account.rs</code> file. Also airdroping some lamports for rent/transfer purposes.</p>
<p>Now add following code in the <code>flow1()</code> function of <code>#[flow]</code> block:</p>
<div class="mb-codeblock" id="cb-ef2d127d" data-lang="rust">
  
  <div class="mb-codeblock-header">
    <div class="mb-codeblock-left">
      <span class="mb-codeblock-badge">
        RUST
      </span></div>

    <div class="mb-codeblock-actions"><button class="mb-action-btn mb-collapse-btn" data-collapsed="false" aria-label="Collapse code">
          <i class="fas fa-compress-alt"></i>
          <span>Collapse</span>
        </button><button class="mb-action-btn mb-copy-btn" aria-label="Copy code">
        <i class="fas fa-copy"></i>
        <span>Copy</span>
      </button>
    </div>
  </div>

  
  <div 
    class="mb-codeblock-content" 
    data-state="expanded"
  >
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="w">    </span><span class="cp">#[flow]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">flow1</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">signer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">fuzz_accounts</span><span class="p">.</span><span class="n">signer</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">trident</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">vault</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">fuzz_accounts</span><span class="p">.</span><span class="n">vault</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">trident</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nb">Some</span><span class="p">(</span><span class="n">PdaSeeds</span>::<span class="n">new</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="o">&amp;</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="sa">b</span><span class="s">&#34;vault&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">signer</span><span class="p">.</span><span class="n">as_ref</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="fm">pubkey!</span><span class="p">(</span><span class="s">&#34;Your program ID&#34;</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">account</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">trident</span><span class="p">.</span><span class="n">get_account</span><span class="p">(</span><span class="o">&amp;</span><span class="n">vault</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">vault_account_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">account</span><span class="p">.</span><span class="n">data</span><span class="p">().</span><span class="n">len</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">rent_exempt_min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rent</span>::<span class="n">default</span><span class="p">().</span><span class="n">minimum_balance</span><span class="p">(</span><span class="n">vault_account_size</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">trident</span><span class="p">.</span><span class="n">random_from_range</span><span class="p">(</span><span class="n">rent_exempt_min</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="mi">100</span><span class="o">*</span><span class="no">LAMPORTS_PER_SOL</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">ix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DepositInstruction</span>::<span class="n">data</span><span class="p">(</span><span class="n">DepositInstructionData</span>::<span class="n">new</span><span class="p">(</span><span class="n">amount</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">.</span><span class="n">accounts</span><span class="p">(</span><span class="n">DepositInstructionAccounts</span>::<span class="n">new</span><span class="p">(</span><span class="n">signer</span><span class="p">,</span><span class="w"> </span><span class="n">vault</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">.</span><span class="n">instruction</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">trident</span><span class="p">.</span><span class="n">process_transaction</span><span class="p">(</span><span class="o">&amp;</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="s">&#34;Deposit&#34;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span></span></span></code></pre></div><div class="mb-collapse-overlay">
        <button class="mb-expand-trigger">
          <i class="fas fa-chevron-down"></i>
          <span>Click to expand</span>
        </button>
      </div></div>
</div>

<script>
(function() {
  'use strict';
  
  const codeblock = document.getElementById('cb-ef2d127d');
  if (!codeblock) return;

  const copyBtn = codeblock.querySelector('.mb-copy-btn');
  const collapseBtn = codeblock.querySelector('.mb-collapse-btn');
  const content = codeblock.querySelector('.mb-codeblock-content');
  const overlay = codeblock.querySelector('.mb-collapse-overlay');
  const expandTrigger = overlay?.querySelector('.mb-expand-trigger');

  
  
  
  if (copyBtn) {
    copyBtn.addEventListener('click', async function() {
      let codeText = '';

      
      const codeCell = codeblock.querySelector('.lntd:last-child code');
      if (codeCell) {
        codeText = codeCell.textContent || codeCell.innerText || '';
      } else {
        
        const codeEl = codeblock.querySelector('pre code');
        codeText = codeEl ? (codeEl.textContent || codeEl.innerText || '') : '';
      }

      try {
        await navigator.clipboard.writeText(codeText.trim());
        
        
        const originalHTML = copyBtn.innerHTML;
        copyBtn.innerHTML = '<i class="fas fa-check"></i><span>Copied!</span>';
        copyBtn.classList.add('mb-btn-success');
        
        setTimeout(() => {
          copyBtn.innerHTML = originalHTML;
          copyBtn.classList.remove('mb-btn-success');
        }, 2000);
      } catch (err) {
        console.error('Failed to copy code:', err);
        
        
        const textArea = document.createElement('textarea');
        textArea.value = codeText.trim();
        textArea.style.position = 'fixed';
        textArea.style.opacity = '0';
        document.body.appendChild(textArea);
        textArea.select();
        
        try {
          document.execCommand('copy');
          copyBtn.innerHTML = '<i class="fas fa-check"></i><span>Copied!</span>';
          setTimeout(() => {
            copyBtn.innerHTML = '<i class="fas fa-copy"></i><span>Copy</span>';
          }, 2000);
        } catch (fallbackErr) {
          console.error('Fallback copy failed:', fallbackErr);
        }
        
        document.body.removeChild(textArea);
      }
    });
  }

  
  
  
  if (collapseBtn && content && overlay) {
    const collapsedHeight =  200 ;
    
    function toggleCollapse() {
      const isCollapsed = content.dataset.state === 'collapsed';
      
      if (isCollapsed) {
        
        content.style.maxHeight = '';
        content.style.overflow = '';
        content.dataset.state = 'expanded';
        overlay.style.display = 'none';
        collapseBtn.innerHTML = '<i class="fas fa-compress-alt"></i><span>Collapse</span>';
        collapseBtn.dataset.collapsed = 'false';
      } else {
        
        content.style.maxHeight = collapsedHeight + 'px';
        content.style.overflow = 'hidden';
        content.dataset.state = 'collapsed';
        overlay.style.display = 'flex';
        collapseBtn.innerHTML = '<i class="fas fa-expand-alt"></i><span>Expand</span>';
        collapseBtn.dataset.collapsed = 'true';
      }
    }

    
    if ('expanded' === 'collapsed') {
      content.dataset.state = 'collapsed';
      overlay.style.display = 'flex';
      collapseBtn.innerHTML = '<i class="fas fa-expand-alt"></i><span>Expand</span>';
      collapseBtn.dataset.collapsed = 'true';
    }

    collapseBtn.addEventListener('click', toggleCollapse);
    
    if (expandTrigger) {
      expandTrigger.addEventListener('click', toggleCollapse);
    }
  }
})();
</script>

<style>
 

.mb-codeblock-filename {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  color: var(--color-text);
  font-size: 0.75rem;
  font-weight: 500;
  padding: 0.2rem 0.6rem;
  border-radius: 0.35rem;
  background: color-mix(in srgb, var(--color-bg) 40%, transparent);
  border: 1px solid color-mix(in srgb, var(--color-border) 60%, transparent);
}

.mb-action-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  background: transparent;
  border: 1px solid color-mix(in srgb, var(--color-border) 70%, transparent);
  color: var(--color-text-muted);
  cursor: pointer;
  font-size: 0.7rem;
  padding: 0.35rem 0.65rem;
  border-radius: 0.4rem;
  transition: all 0.15s ease-out;
  font-family: inherit;
}

.mb-action-btn:hover {
  color: var(--color-accent);
  background: color-mix(in srgb, var(--color-accent) 12%, transparent);
  border-color: var(--color-accent);
  transform: translateY(-1px);
}

.mb-action-btn:active {
  transform: translateY(0);
}

.mb-action-btn i {
  font-size: 0.7rem;
}

.mb-btn-success {
  color: #22c55e !important;
  border-color: #22c55e !important;
  background: color-mix(in srgb, #22c55e 12%, transparent) !important;
}

.mb-collapse-overlay {
  display: none;
  position: absolute;
  inset: 0;
  background: linear-gradient(
    to bottom,
    transparent 0%,
    rgba(0, 0, 0, 0.3) 40%,
    rgba(0, 0, 0, 0.85) 100%
  );
  align-items: flex-end;
  justify-content: center;
  padding-bottom: 1rem;
  cursor: pointer;
  z-index: 10;
}

.mb-expand-trigger {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  padding: 0.4rem 0.8rem;
  border-radius: 0.5rem;
  border: 1px solid var(--color-accent);
  background: color-mix(in srgb, var(--color-accent) 20%, transparent);
  color: var(--color-accent);
  font-size: 0.75rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s ease-out;
  backdrop-filter: blur(8px);
}

.mb-expand-trigger:hover {
  background: color-mix(in srgb, var(--color-accent) 30%, transparent);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(168, 85, 247, 0.3);
}

.mb-expand-trigger i {
  font-size: 0.7rem;
  animation: bounce 1.5s infinite;
}

@keyframes bounce {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(3px);
  }
}

 
.mb-codeblock[data-lang="javascript"] .mb-codeblock-badge,
.mb-codeblock[data-lang="js"] .mb-codeblock-badge {
  background: color-mix(in srgb, #f7df1e 25%, transparent);
  color: #f7df1e;
}

.mb-codeblock[data-lang="typescript"] .mb-codeblock-badge,
.mb-codeblock[data-lang="ts"] .mb-codeblock-badge {
  background: color-mix(in srgb, #3178c6 25%, transparent);
  color: #3178c6;
}

.mb-codeblock[data-lang="python"] .mb-codeblock-badge,
.mb-codeblock[data-lang="py"] .mb-codeblock-badge {
  background: color-mix(in srgb, #3776ab 25%, transparent);
  color: #3776ab;
}

.mb-codeblock[data-lang="go"] .mb-codeblock-badge {
  background: color-mix(in srgb, #00add8 25%, transparent);
  color: #00add8;
}

.mb-codeblock[data-lang="rust"] .mb-codeblock-badge,
.mb-codeblock[data-lang="rs"] .mb-codeblock-badge {
  background: color-mix(in srgb, #ce422b 25%, transparent);
  color: #ce422b;
}

.mb-codeblock[data-lang="html"] .mb-codeblock-badge {
  background: color-mix(in srgb, #e34c26 25%, transparent);
  color: #e34c26;
}

.mb-codeblock[data-lang="css"] .mb-codeblock-badge {
  background: color-mix(in srgb, #264de4 25%, transparent);
  color: #264de4;
}

.mb-codeblock[data-lang="bash"] .mb-codeblock-badge,
.mb-codeblock[data-lang="sh"] .mb-codeblock-badge,
.mb-codeblock[data-lang="shell"] .mb-codeblock-badge {
  background: color-mix(in srgb, #4eaa25 25%, transparent);
  color: #4eaa25;
}

.mb-codeblock[data-lang="json"] .mb-codeblock-badge {
  background: color-mix(in srgb, #000000 25%, transparent);
  color: #dddddd;
}

.mb-codeblock[data-lang="yaml"] .mb-codeblock-badge,
.mb-codeblock[data-lang="yml"] .mb-codeblock-badge {
  background: color-mix(in srgb, #cb171e 25%, transparent);
  color: #cb171e;
}
</style><p>In the first line we are getting <code>signer</code> from the <code>start()</code> function. On the next line we are initializing <code>vault</code> account with its seeds. If you check our program again then you can see that we need rent to be provided to the <code>vault</code> accounts that we are going to be initializing so that&rsquo;s what next four lines of code are for.</p>
<p>In the next line the instruction is created. To create instruction you need to check <code>types.rs</code> file. There you can see implementation of each function instruction. In <code>vault</code> program in <code>deposit()</code> function we are taking amount as parameter so that why we populate <code>DepositInstructionData::new()</code> with <code>amount</code>. Also we need to provide two accounts (<code>signer</code>, <code>vault</code>) to <code>DepositInstructionAccounts::new()</code>.</p>
<p>Now we are remain with our last function which is <code>withdraw()</code>. Let&rsquo;s change <code>flow2()</code> function like this:</p>
<div class="mb-codeblock" id="cb-e7f6c011" data-lang="rust">
  
  <div class="mb-codeblock-header">
    <div class="mb-codeblock-left">
      <span class="mb-codeblock-badge">
        RUST
      </span></div>

    <div class="mb-codeblock-actions"><button class="mb-action-btn mb-collapse-btn" data-collapsed="false" aria-label="Collapse code">
          <i class="fas fa-compress-alt"></i>
          <span>Collapse</span>
        </button><button class="mb-action-btn mb-copy-btn" aria-label="Copy code">
        <i class="fas fa-copy"></i>
        <span>Copy</span>
      </button>
    </div>
  </div>

  
  <div 
    class="mb-codeblock-content" 
    data-state="expanded"
  >
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="w">    </span><span class="cp">#[flow]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">flow2</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">signer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">fuzz_accounts</span><span class="p">.</span><span class="n">signer</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">trident</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">vault</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">fuzz_accounts</span><span class="p">.</span><span class="n">vault</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">trident</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">ix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WithdrawInstruction</span>::<span class="n">data</span><span class="p">(</span><span class="n">WithdrawInstructionData</span>::<span class="n">new</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">.</span><span class="n">accounts</span><span class="p">(</span><span class="n">WithdrawInstructionAccounts</span>::<span class="n">new</span><span class="p">(</span><span class="n">signer</span><span class="p">,</span><span class="w"> </span><span class="n">vault</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">.</span><span class="n">instruction</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">trident</span><span class="p">.</span><span class="n">process_transaction</span><span class="p">(</span><span class="o">&amp;</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="s">&#34;Withdraw&#34;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span></span></span></code></pre></div><div class="mb-collapse-overlay">
        <button class="mb-expand-trigger">
          <i class="fas fa-chevron-down"></i>
          <span>Click to expand</span>
        </button>
      </div></div>
</div>

<script>
(function() {
  'use strict';
  
  const codeblock = document.getElementById('cb-e7f6c011');
  if (!codeblock) return;

  const copyBtn = codeblock.querySelector('.mb-copy-btn');
  const collapseBtn = codeblock.querySelector('.mb-collapse-btn');
  const content = codeblock.querySelector('.mb-codeblock-content');
  const overlay = codeblock.querySelector('.mb-collapse-overlay');
  const expandTrigger = overlay?.querySelector('.mb-expand-trigger');

  
  
  
  if (copyBtn) {
    copyBtn.addEventListener('click', async function() {
      let codeText = '';

      
      const codeCell = codeblock.querySelector('.lntd:last-child code');
      if (codeCell) {
        codeText = codeCell.textContent || codeCell.innerText || '';
      } else {
        
        const codeEl = codeblock.querySelector('pre code');
        codeText = codeEl ? (codeEl.textContent || codeEl.innerText || '') : '';
      }

      try {
        await navigator.clipboard.writeText(codeText.trim());
        
        
        const originalHTML = copyBtn.innerHTML;
        copyBtn.innerHTML = '<i class="fas fa-check"></i><span>Copied!</span>';
        copyBtn.classList.add('mb-btn-success');
        
        setTimeout(() => {
          copyBtn.innerHTML = originalHTML;
          copyBtn.classList.remove('mb-btn-success');
        }, 2000);
      } catch (err) {
        console.error('Failed to copy code:', err);
        
        
        const textArea = document.createElement('textarea');
        textArea.value = codeText.trim();
        textArea.style.position = 'fixed';
        textArea.style.opacity = '0';
        document.body.appendChild(textArea);
        textArea.select();
        
        try {
          document.execCommand('copy');
          copyBtn.innerHTML = '<i class="fas fa-check"></i><span>Copied!</span>';
          setTimeout(() => {
            copyBtn.innerHTML = '<i class="fas fa-copy"></i><span>Copy</span>';
          }, 2000);
        } catch (fallbackErr) {
          console.error('Fallback copy failed:', fallbackErr);
        }
        
        document.body.removeChild(textArea);
      }
    });
  }

  
  
  
  if (collapseBtn && content && overlay) {
    const collapsedHeight =  200 ;
    
    function toggleCollapse() {
      const isCollapsed = content.dataset.state === 'collapsed';
      
      if (isCollapsed) {
        
        content.style.maxHeight = '';
        content.style.overflow = '';
        content.dataset.state = 'expanded';
        overlay.style.display = 'none';
        collapseBtn.innerHTML = '<i class="fas fa-compress-alt"></i><span>Collapse</span>';
        collapseBtn.dataset.collapsed = 'false';
      } else {
        
        content.style.maxHeight = collapsedHeight + 'px';
        content.style.overflow = 'hidden';
        content.dataset.state = 'collapsed';
        overlay.style.display = 'flex';
        collapseBtn.innerHTML = '<i class="fas fa-expand-alt"></i><span>Expand</span>';
        collapseBtn.dataset.collapsed = 'true';
      }
    }

    
    if ('expanded' === 'collapsed') {
      content.dataset.state = 'collapsed';
      overlay.style.display = 'flex';
      collapseBtn.innerHTML = '<i class="fas fa-expand-alt"></i><span>Expand</span>';
      collapseBtn.dataset.collapsed = 'true';
    }

    collapseBtn.addEventListener('click', toggleCollapse);
    
    if (expandTrigger) {
      expandTrigger.addEventListener('click', toggleCollapse);
    }
  }
})();
</script>

<style>
 

.mb-codeblock-filename {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  color: var(--color-text);
  font-size: 0.75rem;
  font-weight: 500;
  padding: 0.2rem 0.6rem;
  border-radius: 0.35rem;
  background: color-mix(in srgb, var(--color-bg) 40%, transparent);
  border: 1px solid color-mix(in srgb, var(--color-border) 60%, transparent);
}

.mb-action-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  background: transparent;
  border: 1px solid color-mix(in srgb, var(--color-border) 70%, transparent);
  color: var(--color-text-muted);
  cursor: pointer;
  font-size: 0.7rem;
  padding: 0.35rem 0.65rem;
  border-radius: 0.4rem;
  transition: all 0.15s ease-out;
  font-family: inherit;
}

.mb-action-btn:hover {
  color: var(--color-accent);
  background: color-mix(in srgb, var(--color-accent) 12%, transparent);
  border-color: var(--color-accent);
  transform: translateY(-1px);
}

.mb-action-btn:active {
  transform: translateY(0);
}

.mb-action-btn i {
  font-size: 0.7rem;
}

.mb-btn-success {
  color: #22c55e !important;
  border-color: #22c55e !important;
  background: color-mix(in srgb, #22c55e 12%, transparent) !important;
}

.mb-collapse-overlay {
  display: none;
  position: absolute;
  inset: 0;
  background: linear-gradient(
    to bottom,
    transparent 0%,
    rgba(0, 0, 0, 0.3) 40%,
    rgba(0, 0, 0, 0.85) 100%
  );
  align-items: flex-end;
  justify-content: center;
  padding-bottom: 1rem;
  cursor: pointer;
  z-index: 10;
}

.mb-expand-trigger {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  padding: 0.4rem 0.8rem;
  border-radius: 0.5rem;
  border: 1px solid var(--color-accent);
  background: color-mix(in srgb, var(--color-accent) 20%, transparent);
  color: var(--color-accent);
  font-size: 0.75rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s ease-out;
  backdrop-filter: blur(8px);
}

.mb-expand-trigger:hover {
  background: color-mix(in srgb, var(--color-accent) 30%, transparent);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(168, 85, 247, 0.3);
}

.mb-expand-trigger i {
  font-size: 0.7rem;
  animation: bounce 1.5s infinite;
}

@keyframes bounce {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(3px);
  }
}

 
.mb-codeblock[data-lang="javascript"] .mb-codeblock-badge,
.mb-codeblock[data-lang="js"] .mb-codeblock-badge {
  background: color-mix(in srgb, #f7df1e 25%, transparent);
  color: #f7df1e;
}

.mb-codeblock[data-lang="typescript"] .mb-codeblock-badge,
.mb-codeblock[data-lang="ts"] .mb-codeblock-badge {
  background: color-mix(in srgb, #3178c6 25%, transparent);
  color: #3178c6;
}

.mb-codeblock[data-lang="python"] .mb-codeblock-badge,
.mb-codeblock[data-lang="py"] .mb-codeblock-badge {
  background: color-mix(in srgb, #3776ab 25%, transparent);
  color: #3776ab;
}

.mb-codeblock[data-lang="go"] .mb-codeblock-badge {
  background: color-mix(in srgb, #00add8 25%, transparent);
  color: #00add8;
}

.mb-codeblock[data-lang="rust"] .mb-codeblock-badge,
.mb-codeblock[data-lang="rs"] .mb-codeblock-badge {
  background: color-mix(in srgb, #ce422b 25%, transparent);
  color: #ce422b;
}

.mb-codeblock[data-lang="html"] .mb-codeblock-badge {
  background: color-mix(in srgb, #e34c26 25%, transparent);
  color: #e34c26;
}

.mb-codeblock[data-lang="css"] .mb-codeblock-badge {
  background: color-mix(in srgb, #264de4 25%, transparent);
  color: #264de4;
}

.mb-codeblock[data-lang="bash"] .mb-codeblock-badge,
.mb-codeblock[data-lang="sh"] .mb-codeblock-badge,
.mb-codeblock[data-lang="shell"] .mb-codeblock-badge {
  background: color-mix(in srgb, #4eaa25 25%, transparent);
  color: #4eaa25;
}

.mb-codeblock[data-lang="json"] .mb-codeblock-badge {
  background: color-mix(in srgb, #000000 25%, transparent);
  color: #dddddd;
}

.mb-codeblock[data-lang="yaml"] .mb-codeblock-badge,
.mb-codeblock[data-lang="yml"] .mb-codeblock-badge {
  background: color-mix(in srgb, #cb171e 25%, transparent);
  color: #cb171e;
}
</style><p>Similar to <code>flow1()</code> function as we have taken signer from <code>start()</code> same we do here. Our simple fuzzing flow and setup is done.</p>
<p>Now to test fuzzing run the following command:</p>
<div class="mb-codeblock" id="cb-7902699b" data-lang="text">
  
  <div class="mb-codeblock-header">
    <div class="mb-codeblock-left">
      <span class="mb-codeblock-badge">
        TEXT
      </span></div>

    <div class="mb-codeblock-actions"><button class="mb-action-btn mb-collapse-btn" data-collapsed="false" aria-label="Collapse code">
          <i class="fas fa-compress-alt"></i>
          <span>Collapse</span>
        </button><button class="mb-action-btn mb-copy-btn" aria-label="Copy code">
        <i class="fas fa-copy"></i>
        <span>Copy</span>
      </button>
    </div>
  </div>

  
  <div 
    class="mb-codeblock-content" 
    data-state="expanded"
  >
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">trident fuzz run fuzz_0</span></span></code></pre></div><div class="mb-collapse-overlay">
        <button class="mb-expand-trigger">
          <i class="fas fa-chevron-down"></i>
          <span>Click to expand</span>
        </button>
      </div></div>
</div>

<script>
(function() {
  'use strict';
  
  const codeblock = document.getElementById('cb-7902699b');
  if (!codeblock) return;

  const copyBtn = codeblock.querySelector('.mb-copy-btn');
  const collapseBtn = codeblock.querySelector('.mb-collapse-btn');
  const content = codeblock.querySelector('.mb-codeblock-content');
  const overlay = codeblock.querySelector('.mb-collapse-overlay');
  const expandTrigger = overlay?.querySelector('.mb-expand-trigger');

  
  
  
  if (copyBtn) {
    copyBtn.addEventListener('click', async function() {
      let codeText = '';

      
      const codeCell = codeblock.querySelector('.lntd:last-child code');
      if (codeCell) {
        codeText = codeCell.textContent || codeCell.innerText || '';
      } else {
        
        const codeEl = codeblock.querySelector('pre code');
        codeText = codeEl ? (codeEl.textContent || codeEl.innerText || '') : '';
      }

      try {
        await navigator.clipboard.writeText(codeText.trim());
        
        
        const originalHTML = copyBtn.innerHTML;
        copyBtn.innerHTML = '<i class="fas fa-check"></i><span>Copied!</span>';
        copyBtn.classList.add('mb-btn-success');
        
        setTimeout(() => {
          copyBtn.innerHTML = originalHTML;
          copyBtn.classList.remove('mb-btn-success');
        }, 2000);
      } catch (err) {
        console.error('Failed to copy code:', err);
        
        
        const textArea = document.createElement('textarea');
        textArea.value = codeText.trim();
        textArea.style.position = 'fixed';
        textArea.style.opacity = '0';
        document.body.appendChild(textArea);
        textArea.select();
        
        try {
          document.execCommand('copy');
          copyBtn.innerHTML = '<i class="fas fa-check"></i><span>Copied!</span>';
          setTimeout(() => {
            copyBtn.innerHTML = '<i class="fas fa-copy"></i><span>Copy</span>';
          }, 2000);
        } catch (fallbackErr) {
          console.error('Fallback copy failed:', fallbackErr);
        }
        
        document.body.removeChild(textArea);
      }
    });
  }

  
  
  
  if (collapseBtn && content && overlay) {
    const collapsedHeight =  200 ;
    
    function toggleCollapse() {
      const isCollapsed = content.dataset.state === 'collapsed';
      
      if (isCollapsed) {
        
        content.style.maxHeight = '';
        content.style.overflow = '';
        content.dataset.state = 'expanded';
        overlay.style.display = 'none';
        collapseBtn.innerHTML = '<i class="fas fa-compress-alt"></i><span>Collapse</span>';
        collapseBtn.dataset.collapsed = 'false';
      } else {
        
        content.style.maxHeight = collapsedHeight + 'px';
        content.style.overflow = 'hidden';
        content.dataset.state = 'collapsed';
        overlay.style.display = 'flex';
        collapseBtn.innerHTML = '<i class="fas fa-expand-alt"></i><span>Expand</span>';
        collapseBtn.dataset.collapsed = 'true';
      }
    }

    
    if ('expanded' === 'collapsed') {
      content.dataset.state = 'collapsed';
      overlay.style.display = 'flex';
      collapseBtn.innerHTML = '<i class="fas fa-expand-alt"></i><span>Expand</span>';
      collapseBtn.dataset.collapsed = 'true';
    }

    collapseBtn.addEventListener('click', toggleCollapse);
    
    if (expandTrigger) {
      expandTrigger.addEventListener('click', toggleCollapse);
    }
  }
})();
</script>

<style>
 

.mb-codeblock-filename {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  color: var(--color-text);
  font-size: 0.75rem;
  font-weight: 500;
  padding: 0.2rem 0.6rem;
  border-radius: 0.35rem;
  background: color-mix(in srgb, var(--color-bg) 40%, transparent);
  border: 1px solid color-mix(in srgb, var(--color-border) 60%, transparent);
}

.mb-action-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  background: transparent;
  border: 1px solid color-mix(in srgb, var(--color-border) 70%, transparent);
  color: var(--color-text-muted);
  cursor: pointer;
  font-size: 0.7rem;
  padding: 0.35rem 0.65rem;
  border-radius: 0.4rem;
  transition: all 0.15s ease-out;
  font-family: inherit;
}

.mb-action-btn:hover {
  color: var(--color-accent);
  background: color-mix(in srgb, var(--color-accent) 12%, transparent);
  border-color: var(--color-accent);
  transform: translateY(-1px);
}

.mb-action-btn:active {
  transform: translateY(0);
}

.mb-action-btn i {
  font-size: 0.7rem;
}

.mb-btn-success {
  color: #22c55e !important;
  border-color: #22c55e !important;
  background: color-mix(in srgb, #22c55e 12%, transparent) !important;
}

.mb-collapse-overlay {
  display: none;
  position: absolute;
  inset: 0;
  background: linear-gradient(
    to bottom,
    transparent 0%,
    rgba(0, 0, 0, 0.3) 40%,
    rgba(0, 0, 0, 0.85) 100%
  );
  align-items: flex-end;
  justify-content: center;
  padding-bottom: 1rem;
  cursor: pointer;
  z-index: 10;
}

.mb-expand-trigger {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  padding: 0.4rem 0.8rem;
  border-radius: 0.5rem;
  border: 1px solid var(--color-accent);
  background: color-mix(in srgb, var(--color-accent) 20%, transparent);
  color: var(--color-accent);
  font-size: 0.75rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s ease-out;
  backdrop-filter: blur(8px);
}

.mb-expand-trigger:hover {
  background: color-mix(in srgb, var(--color-accent) 30%, transparent);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(168, 85, 247, 0.3);
}

.mb-expand-trigger i {
  font-size: 0.7rem;
  animation: bounce 1.5s infinite;
}

@keyframes bounce {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(3px);
  }
}

 
.mb-codeblock[data-lang="javascript"] .mb-codeblock-badge,
.mb-codeblock[data-lang="js"] .mb-codeblock-badge {
  background: color-mix(in srgb, #f7df1e 25%, transparent);
  color: #f7df1e;
}

.mb-codeblock[data-lang="typescript"] .mb-codeblock-badge,
.mb-codeblock[data-lang="ts"] .mb-codeblock-badge {
  background: color-mix(in srgb, #3178c6 25%, transparent);
  color: #3178c6;
}

.mb-codeblock[data-lang="python"] .mb-codeblock-badge,
.mb-codeblock[data-lang="py"] .mb-codeblock-badge {
  background: color-mix(in srgb, #3776ab 25%, transparent);
  color: #3776ab;
}

.mb-codeblock[data-lang="go"] .mb-codeblock-badge {
  background: color-mix(in srgb, #00add8 25%, transparent);
  color: #00add8;
}

.mb-codeblock[data-lang="rust"] .mb-codeblock-badge,
.mb-codeblock[data-lang="rs"] .mb-codeblock-badge {
  background: color-mix(in srgb, #ce422b 25%, transparent);
  color: #ce422b;
}

.mb-codeblock[data-lang="html"] .mb-codeblock-badge {
  background: color-mix(in srgb, #e34c26 25%, transparent);
  color: #e34c26;
}

.mb-codeblock[data-lang="css"] .mb-codeblock-badge {
  background: color-mix(in srgb, #264de4 25%, transparent);
  color: #264de4;
}

.mb-codeblock[data-lang="bash"] .mb-codeblock-badge,
.mb-codeblock[data-lang="sh"] .mb-codeblock-badge,
.mb-codeblock[data-lang="shell"] .mb-codeblock-badge {
  background: color-mix(in srgb, #4eaa25 25%, transparent);
  color: #4eaa25;
}

.mb-codeblock[data-lang="json"] .mb-codeblock-badge {
  background: color-mix(in srgb, #000000 25%, transparent);
  color: #dddddd;
}

.mb-codeblock[data-lang="yaml"] .mb-codeblock-badge,
.mb-codeblock[data-lang="yml"] .mb-codeblock-badge {
  background: color-mix(in srgb, #cb171e 25%, transparent);
  color: #cb171e;
}
</style><p>Why this matters:</p>
<p>Improves coverage</p>
<p>Produces meaningful execution traces</p>
<p>Simplifies debugging</p>
<p>Makes crash reproduction readable</p>
<p>Structured fuzzing dramatically increases signal quality.</p>
<p>Handlers: The Core of Stateful Fuzzing</p>
<p>Handlers translate fuzz inputs into real protocol interactions.</p>
<p>A handler typically:</p>
<p>Selects a user</p>
<p>Bounds values to meaningful ranges</p>
<p>Calls the target instruction</p>
<p>Updates shadow state</p>
<p>This is where most of the engineering effort goes.</p>
<p>Good handlers simulate adversarial users while maintaining realism.</p>
<p>For example, a deposit handler might:</p>
<p>Choose a random signer</p>
<p>Clamp deposit amount to valid ranges</p>
<p>Execute the deposit instruction</p>
<p>Update local accounting</p>
<p>Handlers are where randomness becomes structured chaos.</p>
<p>The Importance of Shadow State</p>
<p>One of the biggest differences between beginner and professional fuzzing is the use of shadow accounting.</p>
<p>A shadow state is an off-chain model of expected protocol state.</p>
<p>Why it matters:</p>
<p>On-chain state may appear valid even when accounting is broken.</p>
<p>For example:</p>
<p>Internal balances drift</p>
<p>Precision errors accumulate</p>
<p>Value leaks slowly</p>
<p>Without a shadow model, you cannot detect these issues.</p>
<p>Your shadow state should track:</p>
<p>Per-user deposits</p>
<p>Total expected vault balance</p>
<p>Expected withdrawals</p>
<p>You’ll compare this model against on-chain state in invariants.</p>
<p>Writing Strong Invariants</p>
<p>Invariants determine the effectiveness of fuzzing.</p>
<p>Weak invariants give false confidence.</p>
<p>Strong invariants find real bugs.</p>
<p>Let’s break them down.</p>
<p>Basic Invariants</p>
<p>These validate program stability:</p>
<p>No panics</p>
<p>No arithmetic underflows</p>
<p>No invalid state transitions</p>
<p>These are useful but not sufficient for DeFi.</p>
<p>Economic Invariants</p>
<p>This is where fuzzing becomes powerful.</p>
<p>Examples:</p>
<p>Vault solvency</p>
<p>vault_balance &gt;= total_user_balances</p>
<p>Accounting correctness</p>
<p>sum(user_balances) == vault_holdings</p>
<p>No free money</p>
<p>No user should gain value without depositing.</p>
<p>These invariants catch real-world vulnerabilities.</p>
<p>Multi-User Safety</p>
<p>Most DeFi exploits involve multiple actors.</p>
<p>Your fuzzing should model:</p>
<p>Multiple signers</p>
<p>Adversarial ordering</p>
<p>Interleaved deposits and withdrawals</p>
<p>Invariants should hold across arbitrary sequences.</p>
<p>This is where fuzzing shines compared to unit tests.</p>
<p>Running the Fuzzer</p>
<p>Once your fuzz target, handlers, and invariants are ready, running the fuzzer is straightforward:</p>
<p>trident fuzz run vault</p>
<p>During execution, you’ll observe:</p>
<p>Execution counts</p>
<p>Corpus growth</p>
<p>Coverage improvements</p>
<p>Potential crashes</p>
<p>A crash doesn’t always mean a panic.</p>
<p>It can also indicate an invariant violation — which is often more interesting.</p>
<p>Replaying and Debugging Failures</p>
<p>One of Trident’s strongest features is deterministic replay.</p>
<p>When a failure occurs, Trident saves:</p>
<p>The failing input</p>
<p>Execution metadata</p>
<p>Replay instructions</p>
<p>You can reproduce the issue deterministically:</p>
<p>trident fuzz replay <crash-id></p>
<p>This makes fuzzing practical for audits because debugging becomes reproducible and controlled.</p>
<p>Common Design Mistakes</p>
<p>If you’re new to fuzzing, avoid these pitfalls.</p>
<p>Over-constraining handlers</p>
<p>If inputs are too restricted, you reduce exploration.</p>
<p>Under-constraining handlers</p>
<p>If inputs are completely unbounded, you get noise instead of signal.</p>
<p>Weak invariants</p>
<p>Checking only for panics is insufficient for financial protocols.</p>
<p>Ignoring signer permutations</p>
<p>Authority bugs are common in Solana.</p>
<p>Single-user modeling</p>
<p>Most exploits involve multi-user interactions.</p>
<p>Learning to balance realism and adversarial freedom is key.</p>
<p>Fuzzing Like a Professional Auditor</p>
<p>Once you’re comfortable with basics, you can push fuzzing further.</p>
<p>Advanced techniques include:</p>
<p>Authority fuzzing (random signer permutations)</p>
<p>PDA misuse fuzzing</p>
<p>Adversarial sequencing strategies</p>
<p>Long execution sequences</p>
<p>Economic invariant layering</p>
<p>Cross-program interaction fuzzing</p>
<p>At this level, fuzzing becomes a research tool, not just a testing tool.</p>
<p>When to Use Trident</p>
<p>Trident is especially valuable for:</p>
<p>Vault protocols</p>
<p>Lending markets</p>
<p>Liquidation engines</p>
<p>Automated market makers</p>
<p>Yield aggregators</p>
<p>It may be less useful for:</p>
<p>Stateless programs</p>
<p>Simple utilities</p>
<p>Pure data transformations</p>
<p>Focus fuzzing where state and value intersect.</p>
<p>Final Thoughts</p>
<p>Fuzzing is no longer optional for serious smart contract security.</p>
<p>Unit tests validate expectations.</p>
<p>Fuzzing challenges assumptions.</p>
<p>Trident brings powerful, invariant-driven fuzzing to the Solana ecosystem in a practical and ergonomic way.</p>
<p>The key takeaway:</p>
<p>Fuzzing is not about randomness.</p>
<p>It’s about modeling adversarial state transitions.</p>
<p>If you’re building or auditing Solana protocols, learning Trident will significantly increase the depth of your security testing and your ability to uncover subtle, high-impact bugs.</p>

          </div>
        </div>
      </article>

      
        <aside class="article-toc">
          <div class="toc-wrapper">
            <div class="toc-header">
              <h3 class="toc-title">
                <i class="fas fa-list-ul"></i>
                <span>Table of Contents</span>
              </h3>
              <button class="toc-toggle" aria-label="Toggle table of contents">
                <i class="fas fa-chevron-down"></i>
              </button>
            </div>
            <nav class="toc-nav">
              <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#why-fuzzing-matters-in-solana-security-">Why Fuzzing Matters in Solana Security ?</a></li>
        <li><a href="#what-is-trident">What is Trident?</a>
          <ul>
            <li><a href="#unlike-generic-fuzzers-trident-understands">Unlike generic fuzzers, Trident understands:</a></li>
            <li><a href="#mental-model-of-a-trident-fuzz-test">Mental Model of a Trident Fuzz Test</a></li>
            <li><a href="#setup-and-installation">Setup and Installation</a></li>
            <li><a href="#introducing-the-vault-example">Introducing the Vault Example</a></li>
            <li><a href="#designing-the-fuzz-test-setup">Designing the Fuzz Test Setup</a></li>
            <li><a href="#starting-with-writing-fuzz-test">Starting with writing fuzz test</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
            </nav>
          </div>
        </aside>

        <script>
        (function() {
          'use strict';

          const tocWrapper = document.querySelector('.toc-wrapper');
          const tocToggle = document.querySelector('.toc-toggle');
          const tocNav = document.querySelector('.toc-nav');
          const tocLinks = document.querySelectorAll('.toc-nav a');

          if (!tocWrapper || !tocNav) return;

          
          
          
          if (tocToggle) {
            tocToggle.addEventListener('click', function() {
              tocWrapper.classList.toggle('collapsed');
            });
          }

          
          
          
          tocLinks.forEach(link => {
            link.addEventListener('click', function(e) {
              e.preventDefault();
              const targetId = this.getAttribute('href');
              const targetElement = document.querySelector(targetId);

              if (targetElement) {
                const yOffset = -80; 
                const y = targetElement.getBoundingClientRect().top + window.pageYOffset + yOffset;

                window.scrollTo({
                  top: y,
                  behavior: 'smooth'
                });

                
                history.pushState(null, null, targetId);
              }
            });
          });

          
          
          
          const headings = document.querySelectorAll('.markdown-body h1[id], .markdown-body h2[id], .markdown-body h3[id], .markdown-body h4[id], .markdown-body h5[id], .markdown-body h6[id]');

          let activeHeading = null;
          const observer = new IntersectionObserver(
            (entries) => {
              
              const intersectingHeadings = [];
              entries.forEach((entry) => {
                if (entry.isIntersecting) {
                  intersectingHeadings.push({
                    element: entry.target,
                    top: entry.boundingClientRect.top
                  });
                }
              });

              
              if (intersectingHeadings.length > 0) {
                
                intersectingHeadings.sort((a, b) => Math.abs(a.top) - Math.abs(b.top));

                const closestHeading = intersectingHeadings[0].element;
                const id = closestHeading.getAttribute('id');

                if (id && id !== activeHeading) {
                  activeHeading = id;
                  const tocLink = document.querySelector(`.toc-nav a[href="#${id}"]`);

                  if (tocLink) {
                    
                    tocLinks.forEach(link => link.classList.remove('active'));
                    
                    tocLink.classList.add('active');
                  }
                }
              }
            },
            {
              rootMargin: '-80px 0px -80%',
              threshold: [0, 0.25, 0.5, 0.75, 1]
            }
          );

          
          headings.forEach((heading) => {
            observer.observe(heading);
          });

          
          if (tocLinks.length > 0) {
            tocLinks[0].classList.add('active');
            activeHeading = tocLinks[0].getAttribute('href').substring(1);
          }
        })();
        </script>
      
    </div>
  </section>

      </main>

      <footer class="pb-6 pt-10">
  <div class="mx-auto max-w-7xl px-4 sm:px-6">
    <div class="footer-shell">
      <div class="footer-inner">
        
        <div class="space-y-1">
          <p class="footer-small">
            &copy; 2026 Minimal Black Theme — All rights
            reserved.
          </p>

          <p class="footer-small flex flex-wrap items-center gap-1">
            <span>Built with</span>

            <a
              href="https://gohugo.io/"
              class="footer-link footer-float link-underline"
              target="_blank"
              rel="noopener noreferrer"
            >
              <span>Hugo</span>
            </a>

            <span>/</span>

            <a
              href=""
              class="footer-link footer-float link-underline"
              target="_blank"
              rel="noopener noreferrer"
            >
              <span>Minimal&nbsp;Black</span>
            </a>
          </p>
        </div>

        
        
        <div class="footer-links">
          
          <a
            href="https://github.com/aga7hokakological"
            class="footer-link footer-float link-underline"
            target="_blank"
            rel="noopener noreferrer"
          >
            <i class="fa-brands fa-github text-[0.8rem]"></i>
            <span>GitHub</span>
          </a>
          
          <a
            href="https://x.com/0xagathokako"
            class="footer-link footer-float link-underline"
            target="_blank"
            rel="noopener noreferrer"
          >
            <i class="fa-brands fa-twitter text-[0.8rem]"></i>
            <span>X</span>
          </a>
          
          <a
            href="https://www.linkedin.com/in/saurabh-mandavkar/"
            class="footer-link footer-float link-underline"
            target="_blank"
            rel="noopener noreferrer"
          >
            <i class="fa-brands fa-linkedin-in text-[0.8rem]"></i>
            <span>LinkedIn</span>
          </a>
          
          <a
            href="iamsaurabhmandavkar@protonmail.com"
            class="footer-link footer-float link-underline"
            target="_blank"
            rel="noopener noreferrer"
          >
            <i class="fa-regular fa-envelope text-[0.8rem]"></i>
            <span>Email</span>
          </a>
          
        </div>
        
      </div>
    </div>
  </div>
</footer>

    </div>
    <div class="search-overlay" data-search-overlay>
  <div class="search-overlay-backdrop" data-search-close></div>

  <div class="search-panel">
    <div class="search-panel-header">
      <div class="search-input-wrap">
        <i class="fa-solid fa-magnifying-glass text-[0.8rem] text-muted"></i>
        <input
          type="search"
          class="search-input"
          placeholder="Search posts..."
          autocomplete="off"
          data-search-input
        />
      </div>
      <button
        type="button"
        class="search-close"
        data-search-close
        aria-label="Close search"
      >
        <i class="fa-solid fa-xmark text-[0.8rem]"></i>
      </button>
    </div>

    <div class="search-panel-body">
      <div class="search-results" data-search-results>
        <div class="search-empty-state">
          <div class="search-empty-icon">
            <i class="fa-solid fa-magnifying-glass text-[1rem]"></i>
          </div>
          <p class="search-empty-title">Start searching</p>
          <p class="search-empty-subtitle">
            Enter keywords to search articles.
          </p>
        </div>
      </div>

      <div class="search-footer-hints">
        <div class="search-hint-key">
          <span>↑↓</span>
          <span>Navigate</span>
        </div>
        <div class="search-hint-key">
          <span>↵</span>
          <span>Select</span>
        </div>
        <div class="search-hint-key">
          <span>ESC</span>
          <span>Close</span>
        </div>
        <div class="search-hint-key search-hint-right">
          <span>Ctrl</span><span>K</span>
          <span>Shortcut</span>
        </div>
      </div>
    </div>
  </div>
</div>

    <div class="dock" data-dock>
  <div class="dock-inner">
    
    <div class="dock-panel" data-dock-panel>
      
      
      <button
        type="button"
        class="dock-action"
        data-dock-action="back"
        aria-label="Go back"
      >
        <i class="fa-solid fa-arrow-left text-[0.7rem]"></i>
      </button>
      <span class="dock-divider" aria-hidden="true"></span>
      

      
      <button
        type="button"
        class="dock-action"
        data-dock-action="search"
        aria-label="Search"
        onclick="window.MinimalSearch && window.MinimalSearch.open()"
      >
        <i class="fa-solid fa-magnifying-glass text-[0.7rem]"></i>
      </button>

      
      <span class="dock-divider" aria-hidden="true"></span>

      
      <button
        type="button"
        class="dock-action"
        data-dock-action="top"
        aria-label="Back to top"
      >
        <i class="fa-solid fa-arrow-up text-[0.7rem]"></i>
      </button>
    </div>

    
    <button
      type="button"
      class="dock-toggle"
      aria-label="Open quick actions"
      data-dock-toggle
    >
      <span class="dock-toggle-dots"></span>
    </button>
  </div>
</div>

    <script src="/js/main.js" defer></script>
    <script src="/js/search.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/glightbox/dist/js/glightbox.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justified-gallery@3.8.2/dist/js/justifiedGallery.min.js" defer></script>
    <script src="/js/lightbox.js" defer></script>
    <script src="/js/gallery.js" defer></script>
  </body>
</html>
